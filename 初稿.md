# 第2章 相关理论基础

## 2.1 引言

本章主要介绍与本文研究相关的基础理论知识。首先对车辆路径问题进行概述，阐述其基本定义、构成要素及分类方式。其次，对本文研究的核心问题——无人机卡车协同配送问题进行理论阐述，包括问题的定义、构成元素及弧中同步机制的原理。然后，介绍旋翼无人机能耗模型的相关理论，基于Liu等人[3]和Zeng等人[25]的研究成果，重点说明功耗的三分量结构以及载重、速度与能耗之间的非线性关系。最后，对VRP问题的常用求解算法进行归纳总结，包括精确算法、传统启发式算法和智能启发式算法。

## 2.2 车辆路径问题

### 2.2.1 车辆路径问题简述

车辆路径问题（Vehicle Routing Problem, VRP）是组合优化领域中最为经典的问题之一，其核心关注如何设计合理的车辆行驶路线以达成运输效益的最大化。通常情况下，车辆路径问题可以描述为：考虑一组装载地点及卸载地点，规划合理的路径安排使得车队能够有序地经过这些地点，同时还要符合一系列预设的约束条件（例如货物的需求数量、车辆承载能力限定、顾客的时间要求等），并最终达到指定的优化目标（如行程最短、花费最低、送达时间尽可能减少、使用的车辆数量越少越好等）。基础版本的车辆路径问题可以用图论语言描述：给定一个完全图$G=(V,A)$，其中$V$为节点集合（包含配送中心和客户点），$A$为弧集合，每辆车从配送中心出发，访问完其路径上的客户点后需返回配送中心，从而构成一个封闭回路。

VRP问题自1959年由Dantzig和Ramser首次提出以来，在现代物流、配送和邮政服务等领域展现出重要的应用价值，主要体现在以下几个方面：

（1）提高效率。VRP通过优化车辆的路径规划和装载策略，可以显著提高物流和配送的效率。通过减少不必要的行驶时间和距离，有助于降低运输成本，包括燃料成本、时间成本和运输成本等。

（2）降低运输成本。通过合理规划车辆的路径和装载策略，可以减少车辆数量和行驶距离，从而降低燃料成本和运输成本。

（3）提高服务质量。VRP不仅关注运输效率，还关注服务质量。通过优化车辆的路径规划，可以确保车辆按时到达客户点，从而提高客户满意度。

（4）环境友好。通过减少不必要的行驶时间和距离，有助于减少燃油消耗和排放，对环境产生积极影响。

（5）支持决策。VRP为企业提供了一种强大的工具，通过分析路径规划的解决方案，企业可以了解车辆使用效率、运输成本分布等信息，从而做出更有效的决策。

### 2.2.2 车辆路径问题的构成因素

目标优化、配送中心、客户、配送车辆以及道路网络等五个要素共同构建了车辆路径问题。模型中各个组成部分的特性和它们之间的联系，直接决定了车辆路径问题的分类。各组成部分的具体内容如下：

（1）优化目标

车辆路径问题的优化目标一般为最小化总成本、满足服务需求、提高服务质量、减少运输时间、减少车辆数量、提高车辆利用率、满足环境要求等。在无人机卡车协同配送问题中，常见的优化目标包括最小化总完成时间（makespan）和最小化总运输成本。

（2）配送中心

配送车辆从配送中心出发，按照顺序访问客户点，在客户点完成服务后返回配送中心。可以依据配送中心的数目对问题进行分类，包括单一配送中心和多个配送中心的车辆路径规划问题。在本文的研究中，考虑单一配送中心（仓库）的情景，尽管只存在一个物理仓库位置，但在模型符号表示上将其分配为两个不同节点编号，车辆从编号0（仓库起点）出发，最终返回编号$c+1$（仓库终点）。

（3）客户

客户是配送车辆或无人机访问的对象。在本文研究的enRTSP-DVS问题中，每个客户点具有确定的需求量和可服务时间窗$[e_i, l_i]$，且每个客户最多且只能被卡车或无人机服务一次，客户需求不可拆分。

（4）配送车辆

在本文研究的无人机卡车协同配送问题中，配送工具包括地面卡车和空中无人机两类。卡车具有载重限制$Q_T$，以固定速度$v_T$行驶；无人机具有最大装载量$q_D$，可从预设的速度档位集合$V=\{v_1, v_2, \dots, v_s\}$中选择飞行速度。无人机搭载在卡车上，卡车充当移动基站的角色，负责无人机的发射、回收、电池更换和包裹装载。

（5）道路网络

道路网络通常以图形方式表示，其中每个节点代表一个地理位置，而边则代表连接这些节点的道路。在无人机卡车协同配送问题中，卡车在道路网络上行驶，而无人机可以沿直线距离飞行（crow-fly distance），这意味着无人机的飞行距离通常短于卡车的行驶距离，这也是无人机能够提升配送效率的重要原因之一。

### 2.2.3 车辆路径问题的分类

有容量约束的车辆路径问题（CVRP）是目前最基础也是学者们广泛研究的车辆路径问题。在CVRP的基础上，根据不同的约束条件，VRP有不同的类型和扩展：（1）按照配送中心数目划分，可以分为单配送中心和多配送中心路径规划问题。（2）根据车辆种类划分，可以分为单车型和多车型路径规划问题。（3）根据优化目标划分，可以分为单目标和多目标路径规划。（4）根据服务特性划分，可以分为取货、送货以及取送货车辆路径问题。（5）根据顾客是否存在时间限制，可以分为有时间窗约束（硬时间窗、软时间窗、多时间窗）和无时间窗约束两类。（6）按照已知信息的确定性划分，可以分为静态问题和动态问题。（7）根据配送工具类型划分，近年来出现了无人机辅助的车辆路径问题（如TSP-D、FSTSP、VRP-D等），这类问题将无人机与传统车辆相结合，形成了协同配送的新型路径优化问题，也是本文研究的核心范畴。

## 2.3 无人机卡车协同配送问题相关理论

无人机卡车协同配送问题是VRP问题在融合空中无人机配送工具后产生的重要扩展形式，属于一类复杂的NP-hard问题。本文研究的enRTSP-DVS问题在此类问题基础上进一步增加了弧中同步操作、速度可变无人机特性以及安全冗余电量约束。下面就enRTSP-DVS问题的定义、构成元素以及弧中同步机制进行详细介绍。

### 2.3.1 enRTSP-DVS问题的定义

本文研究的考虑弧中同步的速度可变无人机与卡车协同配送路径问题（en Route Truck-drone Scheduling Problem with Drone Variable Speed, enRTSP-DVS）可以定义如下：

给定一个无向图$G=(N,A)$，其中$C=\{1,2,\dots,c\}$代表所有客户点的集合，$C_D \subseteq C$代表能够被无人机服务的客户点集合。尽管只存在一个物理仓库位置，但在模型表示中将其分配为两个不同节点编号：车辆从编号0（仓库起点）出发，最终返回编号$c+1$（仓库终点）。因此，集合$N=\{0,1,\dots,c,c+1\}$代表无向图中的所有点。

卡车载重为$Q_T$，卡车上装载的无人机负载能力为$q_D$。对于每个客户点，给定需求$d_i$和可服务时间窗$[e_i, l_i]$。卡车能够在客户点和弧上进行无人机的发射和回收——这一特性称为弧中同步（Synchronization on Arcs）。无人机在满足载重和续航约束下服务客户，同时卡车能够服务其他客户。

该问题的核心特征如下：

（1）弧中同步操作。无人机不仅可以在客户节点被卡车发射和回收，还可以在卡车行驶的弧线上进行起降操作。Li等人[12]将弧上的起降位置定义为移动起降点（moving-LRL, moving Launch/Retrieval Location），即由一辆持续行驶的卡车构成的动态起降平台，无人机的起降操作无需卡车停车等待。与Schermer等人[11]在VRPDERO中将弧上操作限制在预定义的离散点不同，Li等人[12]的TDRP-SA允许在弧上任意位置进行操作，通过数学分析方法精确定位移动起降点。

（2）速度可变特性。无人机可以从预设的速度档位集合$V=\{v_1, v_2, \dots, v_s\}$中选择飞行速度。Raj和Murray[24]的研究表明，在mFSTSP-VDS问题中，将无人机巡航速度作为决策变量，可以实现平均20.4%的配送时间节约，因为无人机功耗是速度和载荷的非线性函数，高速飞行会显著缩减飞行范围。

（3）安全冗余约束。引入安全冗余电量系数$\lambda$，表示无人机需要在保有一定冗余电量的情况下完成配送任务，以应对弧中同步操作中的突发风险。

（4）客户时间窗约束。每个客户节点只能在其时间窗口$[e_i, l_i]$内被服务。

（5）单次服务约束。每个客户最多被服务一次，无人机一次发射只能满足一个客户点的需求。

问题的优化目标是最小化总配送成本，包括卡车运输成本和无人机运输成本。

### 2.3.2 enRTSP-DVS问题的构成元素

（1）优化目标

本文的优化目标是最小化总配送成本，具体由卡车运输成本（与行驶距离成正比）和无人机运输成本（与飞行过程中的能量消耗相关）两部分构成。

（2）配送工具

enRTSP-DVS问题涉及卡车和无人机两类配送工具。卡车以固定速度$v_T$行驶，具有最大载重$Q_T$，不仅承担直接配送职责，还充当无人机的移动基站。无人机搭载于卡车之上，具有最大装载量$q_D$和电池容量$e_2$。参照Raj和Murray[24]的处理方式，无人机的每次飞行任务（sortie）可分为起飞、巡航（去程）、降落配送、起飞（返程）、巡航（回程）、等待回收、降落回收等飞行阶段，其中巡航速度为决策变量，起飞和降落速度为固定参数。

（3）客户点

每个客户点具有地理位置（用坐标表示）、需求量$d_i$和可服务时间窗$[e_i, l_i]$。客户点分为可被无人机服务的客户点集合$C_D$和只能被卡车服务的客户点。

（4）约束条件

enRTSP-DVS问题涉及以下关键约束：载重约束（卡车不超过$Q_T$，无人机不超过$q_D$），续航与安全冗余约束（无人机飞行总能耗加弧中同步额外能耗不超过$\lambda \cdot e_2$），时间窗约束（服务时间在$[e_i, l_i]$之内），弧中同步约束（起降时卡车与无人机时空严格同步），路径连续性约束，以及速度选择约束（每段航程选择唯一速度档位）。

### 2.3.3 弧中同步机制

弧中同步机制是本文研究的核心技术特征之一。传统的无人机卡车协同配送模型（如Murray和Chu[4]的FSTSP，Agatz等人[1]的TSP-D）要求无人机只能在客户节点或配送中心进行发射和回收操作。Marinelli等人[2]率先在TSP-D问题中提出卡车可以沿路线途中发射和回收无人机，但卡车需要在路线上停车等待无人机。

Schermer等人[11]提出了VRPDERO，将弧上操作限定在预定义的离散点上。具体而言，每条弧$(i,j)$被划分为$S$个离散步骤，无人机只能在这些步骤对应的位置被发射或回收。该研究构建了MILP模型，其中决策变量$y_{s_l}^{k,w}$表示无人机$w$在弧$(i,j)$的第$s_l$个步骤处被发射，$z_{s_r}^{k,w}$表示在第$s_r$个步骤处被回收。这种离散化处理使问题可以用标准MILP求解器处理，但损失了一定的精度。

Li等人[12]在TDRP-SA中进一步发展了弧中同步机制。该研究允许无人机在弧上的任意位置而非离散点进行起降操作，提出了一种基于三角几何的数学分析方法精确定位移动起降点。具体而言，对于卡车行驶弧$(A,B)$上的无人机发射操作，给定客户点$I$，利用三角形$\triangle IAB$的几何关系，通过求解以下方程确定起飞点$E$在弧$(A,B)$上的位置$d_{EA}$：

$$d_{EA} = \frac{-h_1 h_2 + d_{IA} h_3 \pm \sqrt{\Delta}}{2(1-h_1^2)}$$

其中$h_1 = -v^d / v^t$为速度比的负值，$h_2$为时间约束相关项，$h_3$为角度余弦，$\Delta$为判别式。当求得的$d_{EA}$满足$0 < d_{EA} < d_{AB}$时，弧上存在可行的移动起降点。为了将上述非线性约束线性化，Li等人[12]进一步提出了两种边界模型——BM-I和BM-II，分别对无人机飞行距离进行上界和下界估计，通过分段线性函数近似实际飞行距离，使问题转化为可由标准求解器处理的混合整数线性规划模型。

## 2.4 无人机能耗模型理论

无人机的能耗特性是影响协同配送系统性能的关键因素。精确的能耗模型对于路径规划和速度优化至关重要。本节基于Liu等人[3]和Zeng等人[25]的研究成果，介绍旋翼无人机的功耗模型及其与载重、速度之间的关系。

### 2.4.1 旋翼无人机功耗模型

Liu等人[3]基于直升机空气动力学理论，提出了多旋翼无人机的稳态功耗模型。该模型将总消耗功率分解为三个分量——诱导功率（induced power, $P_i$）、型阻功率（profile power, $P_o$）和寄生阻力功率（parasite power, $P_{par}$），可以表示为：

$$P = P_i(T, V_{vert}) + P_o(T, V_{air}) + P_{par}(V_{air})$$

（1）诱导功率$P_i$

诱导功率用于产生推力，将空气向下推动以克服无人机总重量。基于致动盘理论（actuator disk theory），刘等人推导出诱导功率的解析表达式：

$$P_i = k_1 T \left( \frac{V_{vert}}{2} + \sqrt{\left(\frac{V_{vert}}{2}\right)^2 + \frac{T}{2\rho A}} \right)$$

其中$T$为总推力，$V_{vert}$为垂直速度，$\rho$为空气密度，$A$为旋翼总桨盘面积，$k_1 \in [0,1]$为修正因子，用于补偿理想均匀气流与实际气流之间的偏差。在悬停状态下（$V_{vert}=0$），诱导功率简化为$P_{i,hover} = c_1 (mg)^{3/2}$，与总重量的$3/2$次方成正比。

（2）型阻功率$P_o$

型阻功率用于克服旋翼桨叶旋转过程中的摩擦阻力。基于叶素理论（blade element theory），总型阻功率可以近似表示为：

$$P_o \approx c_2 T^{3/2} + c_3 (V_{air} \cos\alpha)^2 T^{1/2}$$

其中$c_2$和$c_3$为与桨叶几何参数相关的常数，$V_{air}$为水平空速，$\alpha$为攻角。Liu等人[3]指出，第二项的贡献较小，在实际应用中可令$c_3 = 0$以简化参数辨识过程。

（3）寄生阻力功率$P_{par}$

寄生阻力功率用于克服无人机机体在前飞时受到的空气阻力，与空速的三次方成正比：

$$P_{par} = c_4 V_{air}^3$$

其中$c_4 = C_D \rho A_{quad}/2$，$C_D$为机体阻力系数，$A_{quad}$为迎风截面积。

Liu等人[3]使用3DR IRIS+四旋翼无人机通过三组实验（悬停、恒速升降、循环直线飞行）辨识了全部模型参数：$k_1=0.8554$，$c_2=2.8037 \text{(m/kg)}^{1/2}$，$c_4=0.0296 \text{ kg/m}$，$c_5=0.0279 \text{ Ns/m}$。验证实验表明，该模型在稳态飞行条件下的能量预测误差约为10.7%（起飞）至16.5%（巡航），对于长距离配送任务中稳态阶段占主导的场景具有足够的精度。

Zeng等人[25]从无线通信角度出发，推导了一个更为紧凑的旋翼无人机推进功耗闭式模型：

$$P(V) = \underbrace{P_0\left(1 + \frac{3V^2}{U_{tip}^2}\right)}_{\text{叶片型阻}} + \underbrace{P_i\left(\sqrt{1 + \frac{V^4}{4v_0^4}} - \frac{V^2}{2v_0^2}\right)^{1/2}}_{\text{诱导功率}} + \underbrace{\frac{1}{2}d_0 \rho s A V^3}_{\text{寄生阻力}}$$

其中$P_0$和$P_i$分别为悬停状态下的叶片型阻功率和诱导功率，$U_{tip}$为旋翼叶尖速度，$v_0$为悬停状态下的平均诱导速度，$d_0$为机身阻力比，$s$为旋翼实度（solidity），$\rho$为空气密度，$A$为旋翼桨盘面积。该模型的悬停功率为$P_h = P_0 + P_i$，为有限值，反映了旋翼无人机能够悬停的物理特性。

Zeng等人[25]指出，$P(V)$随速度呈现典型的"U"形曲线特征：随着速度从零增加，功率先下降（因为诱导功率分量递减），经过一个最小功率点后再上升（因为寄生阻力功率分量以$V^3$增长而占主导）。这一特性意味着存在两个重要的特征速度——最大续航速度$V_{me}$（使功率$P(V)$最小的速度，最大化滞空时间）和最大航程速度$V_{mr}$（使单位距离能耗$E_0(V) = P(V)/V$最小的速度，最大化飞行距离）。在实际应用中，通常有$V_{me} < V_{mr} < V_{max}$。

### 2.4.2 载重-能耗关系的线性近似

Dorling等人[21]从MILP建模的角度出发，建立了多旋翼无人机续航与有效载荷相关的功耗模型。基于动量理论，$n$旋翼无人机的悬停功率可以表示为：

$$P = \sqrt{\frac{(W + mg)^3}{2n\rho c}}$$

其中$W$为机架空重，$m$为电池加有效载荷的总重量，$n$为旋翼数量，$c$为单旋翼桨盘面积。Dorling等人[21]提出将上述非线性功率函数进行线性近似：

$$p(m) = \alpha m + \beta$$

其中$\alpha$代表每千克电池和有效载荷重量所消耗的功率（W/kg），$\beta$为维持无人机机架在空中所需的基础功率（W）。以Hexa-B六旋翼无人机为例，在$m = 0\text{-}3$kg范围内进行线性回归，得到$\alpha = 46.7$ W/kg、$\beta = 26.9$ W，线性近似的平均误差仅为3.1%，最大差值为6.3W。这一线性近似的关键优势在于使得MILP模型中的能耗约束保持线性，确保与主流混合整数规划求解器的兼容性。

Dorling等人[21]的实验进一步表明，无人机在悬停和恒速巡航时的功率消耗基本相同，这意味着在等速飞行假设下，飞行时间可以直接由飞行距离和速度计算，大大简化了能耗模型的应用。然而，该近似在$m$变化范围扩大至$0\text{-}10$kg时，平均误差增至12.8%，因此更适用于小型消费级无人机的应用场景。

### 2.4.3 速度-载荷-能耗的非线性关系

在Liu等人[3]的功耗模型中，推力$T$在稳态平飞时由力平衡方程确定：

$$T = \sqrt{(mg - L)^2 + D^2}$$

其中$L$为升力，$D$为寄生阻力。当无人机携带不同重量的包裹时，总重量$mg$的变化直接改变推力$T$的需求，从而影响诱导功率和型阻功率。同时，飞行速度$V$通过三个分量分别影响总功耗：低速时诱导功率占主导，高速时寄生阻力功率以$V^3$增长而占主导。

这一非线性关系产生了Raj和Murray[24]所揭示的重要发现：在假设固定续航时间或固定飞行范围的传统模型中，提高无人机速度会自然减少总配送时间；但当续航能力被建模为速度和载荷的非线性函数时，高速飞行会显著缩减飞行范围，反而可能增加总配送时间。具体而言，重载任务中无人机以较低速度飞行可以最小化单位距离能耗，从而在有限电池容量下覆盖更大的服务范围；轻载任务中适当提速可以缩短飞行时间，而能耗增加相对有限。这种"重载低速节能、轻载高速提效"的策略正是本文引入速度可变无人机的理论依据。

### 2.4.4 安全冗余电量模型

在弧中同步操作模式下，无人机需要在移动的卡车上完成起降，相比传统固定节点操作具有更高的风险性。参考Choi等人[23]提出的"80%飞行规则"——即无人机仅使用80%的电量以应对罕发情况和不确定因素，本文引入安全冗余电量系数$\lambda$（$0 < \lambda \leq 1$）。无人机实际可用于配送任务的电量为$\lambda \cdot e_2$，其中$e_2$为电池总容量。安全冗余约束要求：

$$\text{配送总能耗} + \text{弧中同步额外能耗} \leq \lambda \cdot e_2$$

安全冗余电量的引入虽然缩小了无人机的有效服务半径，但速度可变策略可以通过动态调节飞行速度来补偿这一损失，在确保安全性的前提下最大化覆盖范围。

## 2.5 车辆路径问题的求解算法

VRP被视为NP-hard性质的问题，其解空间随客户数量呈阶乘级增长。随着问题规模的扩大，精确算法可能无法在可接受的时间内产生高品质的结果，研究者们开始倾向于启发式方法。

### 2.5.1 精确算法

精确算法将车辆路径问题视为整数规划问题进行求解，常用方法包括：（1）枚举法，列出所有可能解，适用于小规模问题。（2）分支定界法（Branch and Bound），结合分支和定界步骤逐步缩小搜索空间。（3）分支切割法（Branch and Cut），在分支定界法基础上利用割平面增强松弛度。（4）列生成法（Column Generation），将原问题分解为主问题和子问题，仅考虑有前途的变量。

在无人机卡车协同配送问题中，Schermer等人[11]的VRPDERO和Li等人[12]的TDRP-SA均构建了MILP模型。Schermer等人[11]引入了有效不等式以提升求解器性能，但即便如此，精确求解仅适用于小规模实例（Raj和Murray[24]报告其mFSTSP的MILP仅能精确求解8个客户的问题，Sacramento等人[6]的模型仅能求解12个客户的问题）。本文利用Gurobi求解器对小规模算例进行精确求解，以验证模型的准确性。

### 2.5.2 传统启发式算法

传统启发式算法旨在合理时间内找到近似最优解，常用方法包括：（1）扫描算法（Sweep Algorithm），基于"先聚类后路由"的策略，按照极角排序逐一访问客户点。（2）节约里程算法（Savings Algorithm），通过比较路径合并带来的行驶距离减少量来确定最佳组合方式。（3）插入算法，按照特定规则将客户需求逐步插入已有路径中。

在本文的算法设计中，初始解生成阶段采用了基于贪心的插入策略，逐步将客户节点插入到卡车路径中，再将满足约束的客户从卡车路径中提取并分配给无人机执行配送。

### 2.5.3 智能启发式算法

智能启发式算法较传统启发式算法具有更高的灵活性和全局搜索能力。下面介绍几种与本文研究密切相关的算法：

（1）遗传算法（Genetic Algorithm, GA），模拟自然选择和遗传过程寻找最优解，通过种群初始化、适应性评估、选择、交叉与变异操作迭代进化，具备良好的全局搜索能力。

（2）模拟退火算法（Simulated Annealing, SA），起源于固态物体退火过程的物理类比，以一定概率接受劣解从而跳出局部最优。Dorling等人[21]在求解无人机配送VRP时采用了SA算法，通过字符串编码表示解向量，利用成本函数评估路径质量，在实际规模问题中获得了高质量的次优解。

（3）变邻域搜索算法（Variable Neighborhood Search, VNS），核心思想是系统地改变邻域结构以跳出局部最优。Schermer等人[11]在求解VRPDERO时将VNS与禁忌搜索（Tabu Search）相结合，设计了混合VNS/TS算法，其中嵌入了针对VRPDERO结构特性的无人机插入算子，并采用可扩展的分治策略处理大规模实例。

（4）自适应大邻域搜索算法（Adaptive Large Neighborhood Search, ALNS），是本文求解enRTSP-DVS问题的核心算法框架。ALNS由Ropke和Pisinger提出，其基本思想是通过破坏（destroy）和修复（repair）两个阶段对当前解进行大规模改变，从而在更广阔的解空间中搜索。"自适应"体现在算法维护每个算子的历史表现权重，表现越好的算子在后续迭代中被选择的概率越高。

Li等人[12]在求解TDRP-SA时成功应用了ALNS算法。该研究设计了专门针对弧中同步特性的启发式方法：首先构造卡车路径，然后利用算法1（移动起降点搜索算法）在卡车路径的各弧上搜索可行的无人机发射和回收位置。搜索过程基于三角几何关系，依次枚举卡车路径上的各弧，对每条弧计算是否存在满足时间窗和续航约束的移动起降点，从而将客户分配给无人机服务并确定最优的起降位置。

Sacramento等人[6]在求解VRP-D时也采用了ALNS算法，该研究的ALNS框架包含多个破坏算子（随机移除、最差移除、相关移除等）和修复算子（贪心插入、后悔插入等），并通过敏感性分析揭示了无人机载重对节约成本的贡献最大，其次是无人机的速度。

在本文的研究中，将针对enRTSP-DVS问题的特性设计定制化的破坏算子（如时间冲突移除、高能耗移除、随机速度移除等）和修复算子（如能耗最优插入、时间协同插入、动态变速调整等），并结合模拟退火接受准则和自适应权重更新机制，构建适用于求解本文问题的改进ALNS算法。

## 2.6 本章小结

本章系统介绍了本文研究所需的相关理论基础。首先阐述了车辆路径问题的基本概念、构成因素和扩展分类。其次，详细定义了本文核心研究问题——enRTSP-DVS问题，阐述了弧中同步机制的原理：从Schermer等人[11]的离散点方案到Li等人[12]的移动起降点定位方法。然后，基于Liu等人[3]的三分量功耗模型、Zeng等人[25]的闭式推进功耗公式以及Dorling等人[21]的线性近似方法，系统介绍了旋翼无人机的能耗理论，重点阐明了速度-载荷-能耗的非线性关系及其对变速策略的理论支撑。最后，概述了VRP问题的求解算法，重点介绍了本文所采用的ALNS算法框架及其在相关问题中的成功应用。



# 第3章 考虑弧中同步的速度可变无人机与卡车协同配送模型

## 3.1 引言

在第2章中，系统介绍了车辆路径问题、无人机卡车协同配送理论、旋翼无人机能耗模型以及相关求解算法等基础理论。本章将在此基础上，对考虑弧中同步的速度可变无人机与卡车协同配送路径问题（enRTSP-DVS）进行详细的数学建模。首先，对问题场景进行完整描述，阐明卡车与无人机协同配送的运作模式及弧中同步的操作逻辑。其次，给出建模所需的基本假设条件。然后，定义模型涉及的全部参数和决策变量。最后，构建以总配送成本最小化为目标的混合整数规划模型，并对各约束条件的物理含义进行逐一阐释。

## 3.2 问题描述与基本假设

### 3.2.1 问题描述

enRTSP-DVS问题研究的场景如下：一辆卡车搭载一架无人机从配送中心出发，协同完成对一组客户的配送任务后返回配送中心。卡车沿道路网络行驶，负责服务部分客户并充当无人机的移动基站；无人机可沿直线距离飞行，负责服务轻量级且位于其飞行范围内的客户。

与传统的节点同步模式不同，本文的enRTSP-DVS问题允许无人机在卡车行驶的弧段上进行起飞和降落操作，即弧中同步（en-route synchronization）。传统协同模式（如Murray和Chu[4]的FSTSP、Agatz等人[1]的TSP-D）要求无人机仅在卡车停靠的客户节点进行发射和回收，这种机制实现简单，但在客户稠密或道路受限的场景下会产生明显的等待时间（卡车等无人机或无人机等卡车），并且难以充分发挥无人机的机动性。Marinelli等人[2]率先在TSP-D中引入弧上操作的概念，允许卡车在路线途中的某个位置停车发射或回收无人机。Schermer等人[11]在VRPDERO中将弧上操作限定在预定义的离散点上，通过MILP模型进行建模。然而，离散点方案的精度依赖于离散密度：点集稀疏则解偏差大，点集稠密则变量数量爆炸，导致计算难度指数级增大。

为克服上述局限，本文采用FLR（Flexible Launch/Recovery）连续弧中同步策略。借鉴Li等人[12]的TDRP-SA中移动起降点（moving-LRL）的思想，将弧中同步点的位置表示为连续变量。具体而言，在卡车行驶的弧$(i,j)$上，起飞点的位置由比例参数$\lambda_{ij}^{launch} \in [0,1]$确定——值为0表示起飞点位于节点$i$处，值为1表示位于节点$j$处；回收点的位置同理由参数$\lambda_{ij}^{receive} \in [0,1]$确定。这种连续参数化方法避免了离散化导致的变量爆炸问题，同时保证了弧中同步位置的精度。

此外，本文的enRTSP-DVS问题引入了速度可变特性。如第2章所述，无人机功耗是速度和载荷的非线性函数，固定速度策略（尤其是固定最高速度）可能导致能耗浪费与可行性下降。因此，无人机可以从预设的速度档位集合$V=\{v_1, v_2, \dots, v_s\}$中为每段航程选择合适的飞行速度，实现"速度—能耗—航程—同步等待"之间的统筹优化。图3-1展示了enRTSP-DVS问题的示意图。

在图3-1中，配送中心用圆形标记表示，卡车从配送中心出发，沿实线路径依次访问部分客户点进行配送服务。无人机搭载于卡车之上，在卡车行驶过程中，可在弧段上的某个位置（起飞点）起飞，以选定的速度飞向无人机客户点完成配送，随后以可能不同的速度飞回卡车行驶的另一弧段上的某个位置（回收点），重新搭载于卡车上继续前行。无人机去程和返程的飞行速度可以不同，构成了速度可变的决策空间。

综上，enRTSP-DVS问题的核心决策包括：（1）客户分配决策——确定每个客户由卡车还是无人机服务；（2）卡车路径决策——确定卡车访问客户点的顺序；（3）弧中同步位置决策——确定无人机在哪条弧上起飞和降落，以及起降点的精确位置；（4）速度选择决策——确定无人机去程和返程各段的飞行速度；（5）时间调度决策——确定各车辆到达和离开各节点的时间，以及无人机起飞和回收的时刻。

### 3.2.2 基本假设

在上述问题场景下，为使模型可行且具有实际意义，本文做出以下基本假设：

假设1：配送网络以单一配送中心为基础，卡车从配送中心出发，在完成所有客户的服务后必须返回配送中心。

假设2：系统包含一辆卡车和一架无人机，无人机搭载于卡车上，随卡车行驶，在满足约束条件时可被发射执行配送任务。

假设3：每个客户点有且只能被服务一次，由卡车或无人机完成服务，客户需求不可拆分。

假设4：卡车以固定速度$v^t$行驶，具有最大载重$Q_T$。卡车在道路网络上行驶，两节点间的行驶距离为已知的路网距离$d_{ij}$。

假设5：无人机沿直线距离飞行（crow-fly distance），具有最大装载量$q^D$。无人机可从预设的速度档位集合$V=\{v_1, v_2, \dots, v_s\}$中选择飞行速度，去程和返程可选择不同的速度。

假设6：无人机每次起飞只能服务一个客户点。无人机完成一次配送任务后必须返回卡车，经过电池更换和包裹装载后方可执行下一次任务。

假设7：无人机可在卡车行驶的弧段上进行起飞和降落操作（弧中同步）。起降操作无需卡车停车，起降点位置由连续参数确定。

假设8：引入安全冗余电量系数$\delta$（$0 < \delta < 1$），无人机在执行配送任务时的总能耗不得超过$(1-\delta) \cdot e^D$，其中$e^D$为电池总容量。这一设计参考了Choi等人[23]提出的"80%飞行规则"，即预留一定比例的电量以应对弧中同步操作中的不确定因素和突发风险。

假设9：每个客户点具有时间窗$[e_i, l_i]$，服务必须在时间窗内开始。允许卡车或无人机早到等待，但不允许迟到。

假设10：道路具有对称性，即两个节点之间的行驶距离在两个方向上相同。不考虑天气、交通拥堵、限行政策等外部因素的影响。

假设11：无人机同一时刻最多执行一个配送任务，不存在多个任务时间重叠的情况。

## 3.3 模型的参数和变量表示

为清晰表述enRTSP-DVS问题的数学模型，本节对模型中涉及的集合、参数和决策变量进行统一定义。表3-1、表3-2和表3-3分别列出了集合符号、参数符号和决策变量的定义。

**表3-1 集合符号说明**

| 符号                      | 定义                                                         |
| ------------------------- | ------------------------------------------------------------ |
| $C$                       | 客户集合，$C=\{1,2,\dots,c\}$                                |
| $N$                       | 所有节点集合，$N=\{0,1,\dots,c,c+1\}$，其中0为仓库起点，$c+1$为仓库终点 |
| $N_o$                     | 客户集合与仓库起点的并集，$N_o = C \cup \{0\}$               |
| $N_d$                     | 客户集合与仓库终点的并集，$N_d = C \cup \{c+1\}$             |
| $A$                       | 所有弧的集合                                                 |
| $V=\{v_1,v_2,\dots,v_s\}$ | 无人机可选速度档位集合                                       |

**表3-2 参数符号说明**

| 符号          | 定义                                       |
| ------------- | ------------------------------------------ |
| $d_{ij}$      | 客户$i$到客户$j$的道路网络距离             |
| $r_{ij}^k$    | 弧$(i,j)$上的发射点到客户$k$的直线飞行距离 |
| $r_{kj}^{ij}$ | 客户$k$到弧$(i,j)$上回收点的直线飞行距离   |
| $v^t$         | 卡车行驶速度                               |
| $s_i$         | 客户$i$的服务时间                          |
| $e^D$         | 无人机电池容量                             |
| $a^t$         | 卡车单位距离运输成本                       |
| $a^d$         | 无人机单位能耗运输成本                     |
| $a^s$         | 弧中同步操作的无人机附加成本               |
| $a^w$         | 等待惩罚成本（单位时间）                   |
| $\alpha_0$    | 空载基础能耗系数                           |
| $\alpha_1$    | 载荷能耗系数                               |
| $\gamma_1$    | 气动阻力能耗系数                           |
| $q^D$         | 无人机最大装载量                           |
| $Q_i$         | 客户$i$的需求量                            |
| $[e_i, l_i]$  | 客户$i$的时间窗口                          |
| $w^d$         | 无人机空载重量                             |
| $M$           | 一个足够大的正常数（Big-M）                |
| $\delta$      | 安全冗余电量系数，$0 < \delta < 1$         |
| $r$           | 无人机单段最大飞行距离                     |

**表3-3 决策变量说明**

| 符号                      | 类型 | 定义                                                         |
| ------------------------- | ---- | ------------------------------------------------------------ |
| $x_{ij}$                  | 二元 | 卡车是否经过弧$(i,j)$，$x_{ij} \in \{0,1\}$                  |
| $y_{ijk}$                 | 二元 | 无人机是否从节点$i$附近起飞，为客户$k$服务，在节点$j$附近降落，$y_{ijk} \in \{0,1\}$ |
| $z_i$                     | 二元 | 客户$i$是否得到服务，$z_i \in \{0,1\}$                       |
| $p_{ij}$                  | 二元 | 卡车是否先于节点$j$访问节点$i$，$p_{ij} \in \{0,1\}$         |
| $\theta_{ijk}^{aij}$      | 二元 | 无人机是否在弧$(i,j)$上起飞，为客户$k$服务                   |
| $\phi_{ijk}^{aij}$        | 二元 | 无人机是否在弧$(i,j)$上降落，为客户$k$服务                   |
| $\lambda_{ijk}^{launch}$  | 连续 | 起飞点在弧$(i,j)$上的位置比例，$\lambda \in [0,1]$，0对应节点$i$，1对应节点$j$ |
| $\lambda_{ijk}^{receive}$ | 连续 | 回收点在弧$(i,j)$上的位置比例，$\lambda \in [0,1]$           |
| $(x_l, y_l)$              | 连续 | 起飞点的平面坐标                                             |
| $(x_r, y_r)$              | 连续 | 回收点的平面坐标                                             |
| $F_{ijk}$                 | 连续 | 起飞点到客户$k$的飞行距离                                    |
| $G_{ijk}$                 | 连续 | 客户$k$到回收点的飞行距离                                    |
| $\beta_{ijk,v}^{aij}$     | 二元 | 无人机在弧$(i,j)$上起飞服务客户$k$时去程是否选择速度$v$      |
| $\eta_{ijk,v}^{aij}$      | 二元 | 无人机在弧$(i,j)$上起飞服务客户$k$时返程是否选择速度$v$      |
| $o_i$                     | 整数 | 节点$i$在卡车路线中的访问顺序，$o_i \in \{0,1,\dots,c+1\}$   |
| $T_{ij}$                  | 连续 | 卡车到达节点$i$后前往节点$j$的出发时刻，$T_{ij} \geq 0$      |
| $t_i$                     | 连续 | 卡车到达节点$i$的时刻，$t_i \geq 0$                          |
| $t_{ijk}^l$               | 连续 | 卡车到达弧中起飞点的时刻                                     |
| $t_{ijk}^r$               | 连续 | 卡车到达弧中回收点的时刻                                     |
| $t_{ijk}^c$               | 连续 | 无人机到达客户$k$的时刻                                      |
| $t_{ijk}^{d1}$            | 连续 | 无人机去程飞行时间                                           |
| $t_{ijk}^{d2}$            | 连续 | 无人机返程飞行时间                                           |
| $t_{ijk}^{ar}$            | 连续 | 无人机到达回收点的时刻                                       |
| $w_{ijk}$                 | 连续 | 同步等待时间（卡车在回收点等待无人机的时间），$w_{ijk} \geq 0$ |
| $w_{ijk}^{d}$             | 连续 | 无人机在回收点等待卡车的时间                                 |
| $r_{ijk,v}^{d1}$          | 连续 | 去程在速度$v$下分配的有效飞行距离                            |
| $r_{ijk,v}^{d2}$          | 连续 | 返程在速度$v$下分配的有效飞行距离                            |
| $E_{ijk}$                 | 连续 | 无人机执行任务$(i,j,k)$的总能耗                              |

需要说明的是，本文模型中将仓库位置分配为两个不同的节点编号（起点0和终点$c+1$），这一处理方式与Murray和Chu[4]的FSTSP模型保持一致，旨在简化路径约束的表达。此外，无人机飞行任务的编码方式$(i,j,k)$借鉴了Murray和Chu[4]提出的三元组（sortie）表示法，其中$i$为起飞弧的起始节点，$j$为回收弧的起始节点，$k$为被服务的客户点。

## 3.4 数学模型

基于上述符号定义和基本假设，构建enRTSP-DVS问题的混合整数规划模型如下。

### 3.4.1 目标函数

$$\min Z = \sum_{i \in N_o} \sum_{j \in N_d} a^t d_{ij} x_{ij} + a^d \sum_{i,j,k \in C} E_{ijk} + a^s \sum_{i,j,k \in C} (\theta_{ijk}^{aij} + \phi_{ijk}^{aij}) \cdot r_{ijk,v} \cdot a^d + a^w \sum_{i,j,k \in C} (w_{ijk} + w_{ijk}^d) \quad (3\text{-}1)$$

目标函数（3-1）表示总配送成本最小化，由四部分构成：第一项为卡车运输成本，与卡车行驶的总距离成正比；第二项为无人机能耗成本，基于无人机执行各配送任务的实际能量消耗计算；第三项为弧中同步操作的附加成本，反映在弧上进行无人机起降操作相对于在节点操作的额外代价；第四项为等待惩罚成本，包括卡车在回收点等待无人机以及无人机在回收点等待卡车的时间惩罚。等待成本的引入借鉴了Li等人[12]的TDRP-SA模型中对等待时间的惩罚机制，旨在激励算法寻找同步时刻更为紧凑的解。

### 3.4.2 服务约束

$$\sum_{i \in N_o} x_{ij} + \sum_{i \in C} \sum_{k \in C} y_{ijk} \leq 1, \quad \forall j \in C \quad (3\text{-}2)$$

$$\sum_{j \in N_d} x_{ij} = \sum_{j \in N_d} x_{ji}, \quad \forall i \in C, \; i \neq j \quad (3\text{-}3)$$

$$\sum_{i \in N_o} \sum_{k \in N_d} y_{ijk} = \sum_{j \in N_d} \sum_{k \in N_d} y_{jik}, \quad \forall j \in C, \; j \neq i, \; j \neq k \quad (3\text{-}4)$$

约束（3-2）确保每个客户最多被服务一次，可由卡车直接服务或由无人机执行配送任务完成服务。这一约束与Murray和Chu[4]的FSTSP模型中的约束(2)一致，是协同配送问题的基础约束。约束（3-3）为卡车的流守恒约束，保证卡车到达某个客户点后必须离开该点前往下一个目的地。约束（3-4）为无人机任务的流守恒约束。

### 3.4.3 需求与覆盖约束

$$z_i \leq \sum_{j \in N_d} x_{ij}, \quad \forall i \in C \quad (3\text{-}5)$$

$$z_i \leq \sum_{j \in C} \sum_{k \in C} y_{jik}, \quad \forall i \in C \quad (3\text{-}6)$$

$$z_i \leq \sum_{j \in N_d} x_{ij} + \sum_{j \in C} \sum_{k \in C} y_{jik}, \quad \forall i \in C \quad (3\text{-}7)$$

约束（3-5）至（3-7）对客户需求是否被满足进行限制。若客户$i$被标记为已服务（$z_i = 1$），则必须存在一条经过该客户的卡车弧或一个服务该客户的无人机任务。

### 3.4.4 路径顺序与子回路消除约束

$$o_i - o_j \geq 1 - (c+2) p_{ij}, \quad \forall i, j \in C, \; i \neq j \quad (3\text{-}8)$$

$$o_i - o_j \leq -1 + (c+2)(1-p_{ij}), \quad \forall i, j \in C, \; i \neq j \quad (3\text{-}9)$$

$$p_{ij} + p_{ji} = 1, \quad \forall i, j \in C, \; i \neq j \quad (3\text{-}10)$$

$$o_i - o_j + 1 \leq (c+2)(1 - x_{ij}), \quad \forall i \in N_o, \; j \in N_d, \; i \neq j \quad (3\text{-}11)$$

约束（3-8）至（3-11）确定卡车路径中各节点的访问顺序，并消除子回路。其中，$o_i$为节点$i$在卡车路线中的顺序位置变量，$p_{ij}$为优先关系变量。约束（3-8）和（3-9）通过顺序变量$o_i$与优先关系变量$p_{ij}$的联动，建立节点间的先后顺序关系。约束（3-10）确保任意两个客户之间的先后关系是唯一确定的。约束（3-11）为MTZ（Miller-Tucker-Zemlin）型子回路消除约束，保证卡车路径形成从仓库起点到仓库终点的连通回路。

### 3.4.5 仓库出发与返回约束

$$\sum_{j \in N_d} x_{0j} = \sum_{i \in N_o} x_{i,c+1} = 1 \quad (3\text{-}12)$$

约束（3-12）确保卡车从仓库起点出发且最终返回仓库终点，且出发和返回各恰好一次。

### 3.4.6 时间连续性约束

$$T_{ij} \geq t_i + \frac{d_{ij}}{v^t} - M(1-x_{ij}), \quad \forall i \in N_o, \; j \in N_d, \; i \neq j \quad (3\text{-}13)$$

$$t_j \geq T_{ij} + s_j - M(1-x_{ij}), \quad \forall i \in C, \; j \in N_d, \; i \neq j \quad (3\text{-}14)$$

约束（3-13）确保时间的连续性：卡车从节点$i$出发前往节点$j$的出发时刻$T_{ij}$不早于卡车到达节点$i$的时刻$t_i$加上从$i$到$j$的行驶时间$d_{ij}/v^t$。约束（3-14）确保卡车在完成客户$j$的服务（服务时间为$s_j$）之前停留在该节点。这两个约束通过Big-M方法在弧$(i,j)$未被选中时自动松弛。

### 3.4.7 弧中同步位置约束

弧中同步的核心在于精确确定无人机在卡车行驶弧上的起降位置。本模型采用连续比例参数$\lambda$表示起降点在弧上的位置，并通过坐标插值获得起降点的精确空间坐标。

$$\theta_{ijk}^{aij} + \phi_{ijk}^{aij} \leq y_{ijk}, \quad \forall i, j, k \in C \quad (3\text{-}15)$$

$$\sum_{j \in C} \sum_{k \in C} \theta_{ijk}^{aij} \leq 1, \quad \forall i \in C \quad (3\text{-}16)$$

约束（3-15）确保起飞弧和降落弧的选择与无人机任务$y_{ijk}$绑定——只有当任务$(i,j,k)$被选中时，弧中同步变量才可取非零值。约束（3-16）保证每次无人机飞行任务的起飞弧选择唯一。

**坐标插值约束：**

$$x_l = x_i + \lambda_{ijk}^{launch} (x_j - x_i), \quad \forall i, j, k \in C \quad (3\text{-}17)$$

$$y_l = y_i + \lambda_{ijk}^{launch} (y_j - y_i), \quad \forall i, j, k \in C \quad (3\text{-}18)$$

$$x_r = x_i + \lambda_{ijk}^{receive} (x_j - x_i), \quad \forall i, j, k \in C \quad (3\text{-}19)$$

$$y_r = y_i + \lambda_{ijk}^{receive} (y_j - y_i), \quad \forall i, j, k \in C \quad (3\text{-}20)$$

约束（3-17）至（3-20）通过线性插值计算起飞点和回收点的平面坐标。当$\lambda = 0$时，起降点位于弧的起始节点$i$处，退化为经典的节点同步；当$\lambda = 1$时，位于弧的终止节点$j$处；当$0 < \lambda < 1$时，位于弧的中间位置，实现真正的弧中同步操作。

**条件激活约束：**

这些约束仅在对应的弧中同步变量被激活时生效，否则通过Big-M约束自动松弛：

$$\left| \cdot \right| \leq M(1 - \theta_{ijk}^{aij}), \quad \forall i, j, k \in C \quad (3\text{-}21 \sim 3\text{-}24)$$

约束（3-21）至（3-24）确保坐标方程仅在选中弧上生效。这种条件激活机制通过Big-M方法实现，保证了模型在未选中弧上不对坐标变量施加约束。

**起降点位置范围约束：**

$$0 \leq \lambda_{ijk}^{launch} \leq x_{ij}, \quad 0 \leq \lambda_{ijk}^{receive} \leq x_{ij}, \quad \forall i, j, k \in C \quad (3\text{-}25)$$

约束（3-25）将弧中起降点的比例参数限定在$[0, x_{ij}]$范围内，确保起降点只能位于卡车实际行驶的弧上。

**弧中操作绑定约束：**

$$\theta_{ijk}^{aij} \leq x_{ij}, \quad \phi_{ijk}^{aij} \leq x_{ij}, \quad \forall i, j, k \in C \quad (3\text{-}26 \sim 3\text{-}27)$$

约束（3-26）和（3-27）将弧中起降操作绑定到卡车路径上，确保无人机只能在卡车实际经过的弧上进行起飞和降落。

### 3.4.8 弧中同步时间约束

弧中同步操作需要精确计算卡车到达起飞点和回收点的时刻，以确保卡车与无人机在时间上的严格协调。

$$t_{ijk}^l \leq t_i + \frac{\lambda_{ijk}^{launch} \cdot d_{ij}}{v^t} + M(1 - \theta_{ijk}^{aij}), \quad \forall i, j, k \in C \quad (3\text{-}28)$$

$$t_{ijk}^l \geq t_i + \frac{\lambda_{ijk}^{launch} \cdot d_{ij}}{v^t} - M(1 - \theta_{ijk}^{aij}), \quad \forall i, j, k \in C \quad (3\text{-}29)$$

$$t_{ijk}^r \leq t_i + \frac{\lambda_{ijk}^{receive} \cdot d_{ij}}{v^t} + M(1 - \phi_{ijk}^{aij}), \quad \forall i, j, k \in C \quad (3\text{-}30)$$

$$t_{ijk}^r \geq t_i + \frac{\lambda_{ijk}^{receive} \cdot d_{ij}}{v^t} - M(1 - \phi_{ijk}^{aij}), \quad \forall i, j, k \in C \quad (3\text{-}31)$$

约束（3-28）至（3-31）精确计算卡车到达弧中同步点的时刻。以起飞点为例，卡车到达起飞点的时刻等于卡车到达弧起始节点$i$的时刻加上卡车在弧上行驶到起飞点所需的时间$\lambda_{ijk}^{launch} \cdot d_{ij} / v^t$。回收点的时刻计算方式类似。这些约束通过上下界的双侧Big-M约束确保等式关系在相应弧被选中时严格成立。

$$t_{ijk}^{ar} \leq t_{ijk}^r + M(1 - \phi_{ijk}^{aij}), \quad \forall i, j, k, b, m, n \in C \quad (3\text{-}32)$$

$$t_{ijk}^{ar} \geq t_{ijk}^r - M(1 - \phi_{ijk}^{aij}), \quad \forall i, j, k, b, m, n \in C \quad (3\text{-}33)$$

约束（3-32）和（3-33）确保无人机到达回收点的时刻与卡车到达回收点时刻之间的时间关系。

### 3.4.9 无人机飞行时间与客户到达时间约束

$$t_{ijk}^c \geq t_{ijk}^l + t_{ijk}^{d1} - M(1 - y_{ijk}), \quad \forall i, j, k \in C \quad (3\text{-}34)$$

$$t_{ijk}^c \leq t_{ijk}^l + t_{ijk}^{d1} + M(1 - y_{ijk}), \quad \forall i, j, k \in C \quad (3\text{-}35)$$

$$t_{ijk}^{ar} = t_{ijk}^c + s_k + t_{ijk}^{d2}, \quad \forall i, j, k \in C \quad (3\text{-}36)$$

约束（3-34）和（3-35）表示无人机到达客户$k$的时刻等于起飞时刻加上去程飞行时间。约束（3-36）表示无人机到达回收点的时刻等于到达客户时刻加上服务时间和返程飞行时间。

### 3.4.10 同步等待约束

$$w_{ijk} \geq t_{ijk}^{ar} - t_{ijk}^r + M(1 - y_{ijk}), \quad \forall i, j, k \in C \quad (3\text{-}37)$$

$$w_{ijk}^d \geq t_{ijk}^r - t_{ijk}^{ar} + M(1 - y_{ijk}), \quad \forall i, j, k \in C \quad (3\text{-}38)$$

约束（3-37）和（3-38）计算同步等待时间。若无人机先于卡车到达回收点（$t_{ijk}^{ar} < t_{ijk}^r$），则无人机需悬停等待卡车，等待时间记入$w_{ijk}^d$；若卡车先于无人机到达回收点（$t_{ijk}^r < t_{ijk}^{ar}$），则卡车需在回收点等待无人机，等待时间记入$w_{ijk}$。等待时间在目标函数中通过惩罚成本$a^w$加以约束。

### 3.4.11 速度选择约束

$$\sum_{v \in V} \beta_{ijk,v}^{aij} = y_{ijk}, \quad \forall i, j, k \in C \quad (3\text{-}39)$$

$$\sum_{v \in V} \eta_{ijk,v}^{aij} = y_{ijk}, \quad \forall i, j, k \in C \quad (3\text{-}40)$$

约束（3-39）和（3-40）确保当无人机任务$(i,j,k)$被选中时，去程和返程各恰好选择一个速度档位。参照Raj和Murray[24]在mFSTSP-VDS中的处理方式，去程和返程允许选择不同的速度，以实现能耗与时间的灵活权衡。

### 3.4.12 飞行距离计算约束

$$F_{ijk} = \sum_{v \in V} r_{ijk,v}^{d1}, \quad \forall i, j, k \in C \quad (3\text{-}41)$$

$$G_{ijk} = \sum_{v \in V} r_{ijk,v}^{d2}, \quad \forall i, j, k \in C \quad (3\text{-}42)$$

约束（3-41）和（3-42）计算无人机去程和返程的飞行距离。飞行距离由起飞点（或客户点）到客户点（或回收点）之间的直线距离确定，通过速度选择变量分配到对应的速度档位下。

### 3.4.13 飞行时间计算约束

$$t_{ijk}^{d1} = \sum_{v \in V} \frac{r_{ijk,v}^{d1}}{v}, \quad \forall i, j, k \in C \quad (3\text{-}43)$$

$$t_{ijk}^{d2} = \sum_{v \in V} \frac{r_{ijk,v}^{d2}}{v}, \quad \forall i, j, k \in C \quad (3\text{-}44)$$

约束（3-43）和（3-44）根据所选速度和飞行距离计算无人机的去程和返程飞行时间。由于每段航程只选择一个速度档位，飞行时间等于飞行距离除以所选速度。

### 3.4.14 载重约束

$$\sum_{i \in C} \sum_{k \in C} Q_k \cdot y_{ijk} \leq q^D, \quad \forall i, j, k \in C \quad (3\text{-}45)$$

约束（3-45）确保无人机每次执行配送任务时，所携带包裹的重量不超过其最大装载量$q^D$。

### 3.4.15 能耗计算与安全冗余约束

$$E_{ijk} = \sum_{v \in V} (\alpha_0 + \alpha_1 Q_k + \gamma_1 v^2) \cdot \frac{r_{ijk,v}^{d1}}{v} + \sum_{v \in V} (\alpha_0 + \gamma_1 v^2) \cdot \frac{r_{ijk,v}^{d2}}{v}, \quad \forall i, j, k \in C \quad (3\text{-}46)$$

$$E_{ijk} \leq (1 - \delta) e^D, \quad \forall i, j, k \in C \quad (3\text{-}47)$$

约束（3-46）计算无人机执行任务$(i,j,k)$的总能耗。能耗模型基于第2章介绍的旋翼无人机功耗理论进行简化处理，将功率分解为三个分量：基础空载能耗$\alpha_0$（对应Liu等人[3]模型中的诱导功率和型阻功率的常值部分）、载荷相关能耗$\alpha_1 Q_k$（反映Dorling等人[21]所揭示的功耗与载荷的近似线性关系）、以及气动阻力能耗$\gamma_1 v^2$（对应寄生阻力功率中速度的高次项影响）。去程携带包裹（重量$Q_k$），因此去程能耗包含载荷项；返程空载飞行，不含载荷项。单位时间能耗乘以飞行时间得到总能耗。

约束（3-47）为安全冗余能量约束，要求无人机执行任务的总能耗不超过电池容量扣除安全冗余后的可用电量$(1-\delta)e^D$。参数$\delta$取值参考Choi等人[23]建议的0.2（即保留20%的电量作为安全冗余），在实际应用中可根据弧中同步操作的风险等级进行调整。

### 3.4.16 时间窗约束

$$e_k \leq t_{ijk}^c \leq l_k, \quad \forall i, j, k \in C \quad (3\text{-}48)$$

约束（3-48）确保无人机到达客户$k$的时刻在客户的可服务时间窗$[e_k, l_k]$内。对于由卡车服务的客户，时间窗约束通过卡车到达时间$t_i$的相关约束隐含保证。

### 3.4.17 无人机任务不重叠约束

$$t_{ijk}^{ar} \leq t_{bmn}^l - M(2 - y_{ijk} - y_{bmn}), \quad \forall i, j, k, b, m, n \in C \quad (3\text{-}49)$$

约束（3-49）保证无人机的多个配送任务在时间上不重叠。若两个任务$(i,j,k)$和$(b,m,n)$同时被选中，则任务$(i,j,k)$的回收完成时刻必须早于任务$(b,m,n)$的起飞时刻。这一约束确保单架无人机在同一时刻最多执行一个配送任务，与Thomas等人[16]的CTDRSP-ELR模型中的无人机调度约束一致。

### 3.4.18 变量域约束

$$x_{ij} \in \{0,1\}, \quad y_{ijk} \in \{0,1\}, \quad z_i \in \{0,1\}, \quad p_{ij} \in \{0,1\} \quad (3\text{-}50)$$

$$\theta_{ijk}^{aij}, \phi_{ijk}^{aij}, \beta_{ijk,v}^{aij}, \eta_{ijk,v}^{aij} \in \{0,1\} \quad (3\text{-}51)$$

$$o_i \in \{0, 1, \dots, c+1\}, \quad T_{ij}, t_i, t_{ijk}^l, t_{ijk}^r, t_{ijk}^c, t_{ijk}^{d1}, t_{ijk}^{d2}, t_{ijk}^{ar}, w_{ijk}, w_{ijk}^d, E_{ijk} \geq 0 \quad (3\text{-}52)$$

$$0 \leq \lambda_{ijk}^{launch} \leq 1, \quad 0 \leq \lambda_{ijk}^{receive} \leq 1 \quad (3\text{-}53)$$

约束（3-50）至（3-53）定义了所有决策变量的取值范围。二元变量取值为$\{0,1\}$，连续变量取值为非负实数，弧中同步位置参数取值于$[0,1]$区间。

## 3.5 模型分析

### 3.5.1 模型特征分析

上述enRTSP-DVS模型是一个包含二元变量、整数变量和连续变量的混合整数规划模型。假设客户点数量为$c$，速度档位数量为$s$，则模型的决策变量规模可估计如下：

（1）路径变量$x_{ij}$的数量为$O(c^2)$；无人机任务变量$y_{ijk}$的数量为$O(c^3)$；弧中同步变量$\theta_{ijk}^{aij}$和$\phi_{ijk}^{aij}$的数量各为$O(c^3)$；速度选择变量$\beta_{ijk,v}^{aij}$和$\eta_{ijk,v}^{aij}$的数量各为$O(c^3 \cdot s)$。

（2）约束数量同样主要由$O(c^3)$量级的弧中同步和速度选择约束决定。

因此，模型的规模随客户数量呈三次方增长。如Raj和Murray[24]所报告，类似的mFSTSP模型仅能精确求解8个客户的问题；Schermer等人[11]的VRPDERO模型在引入弧上离散点后，计算复杂度进一步增大。本文的enRTSP-DVS模型由于同时引入了连续弧中同步参数和速度选择变量，问题复杂度更高，精确求解仅适用于小规模实例验证。对于实际规模的问题（客户数量超过20），需要采用启发式算法进行求解，这将在第4章详细介绍。

### 3.5.2 模型与现有模型的对比

为清晰展示本文模型与现有研究的差异和贡献，表3-4从多个维度对比了enRTSP-DVS模型与相关文献中的代表性模型。

**表3-4 enRTSP-DVS模型与现有模型的对比**

| 特征     | FSTSP[4] | VRPDERO[11] | TDRP-SA[12]  | mFSTSP-VDS[24] | CTDRSP-ELR[16] | enRTSP-DVS(本文) |
| -------- | -------- | ----------- | ------------ | -------------- | -------------- | ---------------- |
| 弧中同步 | ✗        | 离散点      | 连续(非线性) | ✗              | 离散点         | 连续(线性化)     |
| 速度可变 | ✗        | ✗           | ✗            | ✓              | ✗              | ✓                |
| 能耗模型 | 固定续航 | 固定续航    | 固定续航     | 非线性功耗     | 载荷相关       | 速度-载荷耦合    |
| 安全冗余 | ✗        | ✗           | ✗            | ✗              | ✗              | ✓                |
| 时间窗   | ✗        | ✗           | ✓            | ✗              | ✗              | ✓                |
| 等待惩罚 | ✗        | ✗           | ✓            | ✗              | ✗              | ✓                |
| 模型类型 | MILP     | MILP        | MINLP        | —              | MILP           | MIP              |

由表3-4可以看出，本文的enRTSP-DVS模型在以下方面具有创新性：

（1）首次将连续弧中同步与速度可变特性在同一模型中进行联合建模。Li等人[12]的TDRP-SA虽然实现了连续弧中同步，但采用固定速度假设且模型为非线性规划；Raj和Murray[24]的mFSTSP-VDS虽然实现了速度可变，但仅支持节点同步。

（2）采用FLR连续参数化方法将非线性弧中同步约束线性化。与Li等人[12]需要求解二次方程确定移动起降点不同，本文通过比例参数$\lambda$的线性插值直接获取起降点坐标，使模型可由标准MILP求解器处理。

（3）引入安全冗余电量约束，增强了模型在弧中同步操作场景下的实际可行性。

（4）能耗模型同时考虑了载荷和速度的影响，综合了Dorling等人[21]的载荷线性化思想和Raj与Murray[24]的速度决策思想。

## 3.6 本章小结

本章对考虑弧中同步的速度可变无人机与卡车协同配送路径问题（enRTSP-DVS）进行了系统的数学建模。首先描述了问题场景，阐明了FLR连续弧中同步策略的操作逻辑——通过连续比例参数$\lambda$确定起降点在弧上的精确位置，避免了离散化方法的精度损失和变量爆炸问题。其次，给出了11条基本假设条件，并系统定义了6类集合符号、17个参数和24个决策变量。在此基础上，构建了以总配送成本最小化为目标的混合整数规划模型，包含目标函数和53条约束，覆盖了服务约束、路径顺序与子回路消除约束、时间连续性约束、弧中同步位置约束、弧中同步时间约束、速度选择约束、飞行距离与时间计算约束、载重约束、能耗与安全冗余约束、时间窗约束以及任务不重叠约束等多个方面。最后，分析了模型的复杂度特征，并与Murray和Chu[4]的FSTSP、Schermer等人[11]的VRPDERO、Li等人[12]的TDRP-SA、Raj和Murray[24]的mFSTSP-VDS以及Thomas等人[16]的CTDRSP-ELR进行了系统对比，阐明了本文模型的创新之处。由于该模型的规模随客户数量呈三次方增长，精确求解仅适用于小规模实例，因此在下一章中将设计改进的ALNS算法对大规模问题进行高效求解。

# 第4章 求解enRTSP-DVS问题的算法设计

## 4.1 引言

在前一章中，本文针对考虑弧中同步的速度可变无人机与卡车协同配送路径规划问题（enRTSP-DVS），构建了混合整数规划模型，明确了目标函数与各项约束条件。该模型涉及卡车路径决策、无人机任务分配、弧中同步点定位、速度档位选择以及能耗约束等多维度决策变量，属于典型的NP-hard组合优化问题。精确算法在面对大规模实例时难以在合理时间内求解，因此需要设计高效的启发式算法。

在卡车-无人机协同配送问题的求解方法中，启发式算法已被广泛采用。Li等人(2022)针对TDRP-SA问题（考虑弧中同步的卡车-无人机路径问题）采用了ALNS算法，并设计了基于粒子群优化(PSO)的自适应概率机制进行算子选择，在Solomon基准算例上取得了良好的求解效果。Cui等人(2024)针对动态协同配送问题，采用强化学习方法处理弧中同步的起降点决策，其数值实验表明弧中同步策略相比传统节点同步策略可平均节省0.9 h/(无人机·天)的等待时间，总利润提升8.43%。这些研究表明，弧中同步策略能够显著提升协同配送效率，但也对算法设计提出了更高要求。

本章针对上述数学模型，设计一种改进的自适应大邻域搜索算法（Improved Adaptive Large Neighborhood Search，IALNS）进行求解。该算法在经典ALNS框架基础上，结合enRTSP-DVS问题的特性进行了多方面改进，主要包括：（1）设计两阶段初始解生成方法，分别构造卡车路径和无人机任务；（2）针对弧中同步与速度可变特性设计专用破坏和修复算子；（3）提出自适应算子评分策略与权重更新机制；（4）引入速度选择操作，将无人机变速决策嵌入搜索过程，实现能耗-时间-同步的联合优化。本章将依次介绍基本ALNS算法原理、改进算法的详细设计及各组成部分。

## 4.2 ALNS算法

### 4.2.1 ALNS算法基本原理

自适应大邻域搜索（Adaptive Large Neighborhood Search，ALNS）算法由Ropke和Pisinger于2006年提出，是一种广泛应用于组合优化问题的元启发式算法。该算法结合了大邻域搜索（LNS）和自适应机制的优点，在物流配送、生产调度、供应链管理等领域取得了出色的求解效果。

ALNS的核心思想是通过"破坏-修复"（Destroy-Repair）的迭代框架对当前解进行改进。在每次迭代中，算法首先使用破坏算子从当前解中移除部分元素（如客户节点、任务分配等），然后使用修复算子将被移除的元素重新插入解中，形成新的候选解。这种大邻域搜索机制能够帮助算法跳出局部最优解，探索更广阔的解空间。

ALNS的自适应性体现在算子选择策略上。算法维护一组破坏算子和修复算子，每个算子都有一个动态更新的权重值。在搜索过程中，算法根据各算子的历史表现（即对解质量的改善程度）动态调整权重，使得表现优异的算子获得更高的被选概率。这种自适应机制使ALNS能够在搜索过程中自动适应问题特性，平衡搜索的多样性与集中性。Li等人(2022)在求解TDRP-SA问题时进一步将粒子群优化(PSO)机制引入算子选择过程，通过粒子的位置和速度更新公式动态调整破坏-修复算子对的选取概率，使算子选择能够更快地收敛到高效组合上。本文借鉴这一思路，但采用更为简洁的轮盘赌权重更新机制，以降低计算开销。

ALNS算法的主要优点包括以下几个方面。首先是高效性，通过在大邻域内进行搜索，ALNS能够快速跳出局部最优解，提高搜索效率。其次是解质量优越，结合局部搜索算法，ALNS能够在大邻域内找到更好的局部最优解。最后是自适应性强，ALNS能够根据搜索进展和解的质量动态调整搜索策略，适应不同问题的特性。在卡车-无人机协同配送领域，Sacramento等人、Li等人(2022)以及吴廷映等人的研究均采用了ALNS算法框架并取得了良好效果，这为本文算法设计提供了重要参考。

### 4.2.2 ALNS算法步骤

经典ALNS算法的执行过程可以分为以下几个步骤：

**步骤1：初始解构造。** 利用启发式方法构建一个合理的初始可行解，作为算法搜索的起点。

**步骤2：参数初始化。** 设置算法的初始参数，包括算子初始评分、算子初始权重、模拟退火初始温度等，并将当前解和最优解均设定为初始解，将初始解加入可行解池。

**步骤3：终止条件检查。** 检查是否达到停止条件（如最大迭代次数或连续无改进次数），若满足则输出最优解，否则继续执行。

**步骤4：算子权重更新检查。** 检查是否达到算子权重更新周期，若是则根据算子评分更新各算子的选择权重，否则执行下一步。

**步骤5：算子选择与执行。** 利用轮盘赌法根据当前权重选择破坏算子和修复算子，依次执行破坏和修复操作生成新解。

**步骤6：新解接受判定。** 采用模拟退火接受准则判断是否接受新解。若新解优于当前解则直接接受；否则以一定概率接受较差的新解，接受概率为：

$$p(s_{new}, s_{cur}) = \min\left\{\exp\left(\frac{s_{cur} - s_{new}}{T_k}\right)\right\}$$

其中 $T_k$ 代表随着迭代逐步降低的当前温度，初始温度 $T_0 = -s_{cur}/\ln 0.5$，在初始条件下较差的新解有50%的概率被接受。冷却速率 $\omega$ 控制温度的衰减速度。

**步骤7：最优解更新。** 若新解优于全局最优解，则更新最优解并更新相关算子评分。

**步骤8：返回步骤3。** 继续迭代直至满足终止条件。

ALNS算法的伪代码如下：

```
算法4-1 自适应大邻域搜索（ALNS）
输入：初始可行解 x
x_b = x; ρ⁻ = (1,…,1); ρ⁺ = (1,…,1);
repeat
    select destroy method d ∈ Ω⁻ and repair method r ∈ Ω⁺ using ρ⁻ and ρ⁺
    x_t = r(d(x));
    if accept(x_t, x) then
        x = x_t
    end if
    if c(x_t) < c(x_b) then
        x_b = x_t
    end if
    update ρ⁻ and ρ⁺
until stop criterion is met
return x_b
```

其中 $\Omega^-$ 和 $\Omega^+$ 分别表示破坏和修复方法的集合，$\rho^-$ 和 $\rho^+$ 分别表示对应的权重集合。算法初始时所有方法设置相同权重。

## 4.3 初始解生成

对于车辆路径问题，构造初始可行解是算法求解的基础。针对enRTSP-DVS问题同时涉及卡车路径规划和无人机任务分配的特点，本文提出一种两阶段初始解生成算法。第一阶段构造卡车路径，第二阶段在卡车路径基础上进行无人机任务插入与协同优化。Li等人(2022)在求解TDRP-SA问题时采用了类似的分阶段策略，依次完成客户分类、路径构建和子巡程构造三个步骤，其中客户分类的标准是：若客户需求量不超过无人机容量且客户与仓库的飞行距离超过 $(L^U - s_i)/(2v^\mu)$（$L^U$ 为卡车最大工作时间，$s_i$ 为服务时间，$v^\mu$ 为无人机速度），则分类为无人机子巡程客户。本文在此基础上进一步考虑了可变速度与能耗约束的影响。

### 4.3.1 阶段1：构造卡车路径

第一阶段的目标是构造覆盖所有客户的卡车初始路径集合。具体思路为：首先创建新路径，根据一定的选择方式选择客户节点并将其插入路径中；其次，计算所有未插入客户节点在所有可行位置的插入成本；然后，选择最优插入方案执行插入操作；最后，重复上述步骤，逐个将客户节点迭代插入直到所有客户节点被分配到路径中。

算法框架如下：

```
算法4-2 两阶段初始解生成-阶段1 构造卡车路径
输入：enRTSP-DVS算例
1：初始化：创建空路径集合 ℜ=∅，未分配客户集合 C_un = C
2：while C_un ≠ ∅
3：  创建新路径 R=[0]，当前时间 τ=0，累计载重 q=0
4：  当前节点 i=0
5：  while True:
6：    从 C_un 中筛选候选集 C_candidate：
7：      筛选策略：1、距离i最近的k个客户；2、按右时间窗升序排序
8：    for j in C_candidate:
9：      if 客户需求符合无人机载重、能耗约束：
10：       计算插入后到达时间
11：       if 符合时间窗约束：
12：         将客户j插入路径集合R末尾
13：         更新时间
14：       else：
15：         跳过j
16：    if 无客户插入：
17：       返回仓库
18：    将R加入路径集合 ℜ 中
输出：卡车路径集合 ℜ，覆盖所有客户
```

在候选客户筛选中，采用双重策略：一是按距离当前节点的远近选择最近的k个客户，确保路径的紧凑性；二是按客户右时间窗升序排序，优先服务时间窗较紧的客户，减少时间窗违反的可能性。

### 4.3.2 阶段2：无人机任务插入与协同优化

在卡车路径构造完成后，第二阶段从卡车路径中筛选适合由无人机服务的客户，将其从卡车路径中移除并分配为无人机任务，同时确定无人机的起飞弧、降落弧、速度档位等决策。无人机任务的可行性判定涉及能耗计算，本文采用的能耗模型以Liu等人(2017)和Zeng等人(2019)提出的多旋翼无人机功耗理论为基础，通过参数化简化为三项式结构（详见4.4.4节）。

在能耗可行性检查中，需要针对每个候选速度档位 $v \in V$ 计算飞行能耗。Dorling等人(2017)通过对3D Robotics Hexa-B六旋翼无人机的飞行实验证明，在恒定速度飞行条件下，无人机功耗与电池和有效载荷总重量近似呈线性关系 $p(m) = \alpha m + \beta$，其中 $\alpha = 0.217$ kW/kg，$\beta = 0.185$ kW，线性近似的平均误差仅为3.1%。这一结论为初始解生成阶段的快速能耗估计提供了依据：在候选任务筛选时可采用线性近似进行快速判别，而在精确评价阶段则使用完整的非线性能耗模型。

```
算法4-3 两阶段初始解生成-阶段2 无人机任务插入与协同优化
输入：卡车路径集合 ℜ，无人机相关参数
1：初始化：遍历每条路径 R∈ℜ，筛选符合无人机载重的客户，
   形成无人机候选客户集合 C_d
2：for each j in C_d:
3：  遍历路径R中j的前后节点i和k:
4：    计算卡车在i的出发时间 τ_i^U 和在k的到达时间 τ_k^U
5：    对每个速度档位 v ∈ V:
6：      计算无人机飞行时间:
7：        t_fly = (d_ij + d_jk) / v
8：      检查续航约束（安全冗余）:
9：        E_ijk ≤ (1-θ) · e^D
10：     检查时间窗:
11：       τ_i^U + d_ij/v ≤ l_c（到达客户时间）
12：       τ_i^U + t_fly ≤ τ_k^U（与卡车在k点同步）
13：     计算成本节省 Δ
14：  if 存在可行(i, k, v)且Δ > 0:
15：    选择最大Δ的插入方案
16：    从R中移除j，添加无人机任务(i→j→k, v)
17：    更新卡车路径时间线
18：    break
输出：修正后的协同路径集合 ℜ'，包含无人机与卡车任务
```

在无人机任务插入过程中，需要综合考虑以下因素：（1）无人机载重约束，确保客户需求量不超过无人机最大装载量 $q^D$；（2）能耗约束，通过能耗模型计算在给定速度下完成任务所需能量，确保不超过安全冗余电量 $(1-\theta) \cdot e^D$，其中安全冗余系数 $\theta$ 的设定参考了Choi等人提出的80%电量安全规则（即保留20%电量作为安全裕量）；（3）时间窗约束，确保无人机在客户时间窗内到达服务；（4）同步约束，确保无人机能在卡车到达回收弧之前返回。

## 4.4 改进ALNS算法设计

由于enRTSP-DVS问题在传统卡车-无人机协同配送问题基础上增加了弧中同步发射/回收、无人机可变速、客户时间窗以及与包裹重量相关的能耗模型等复杂特性，该问题同样属于NP-hard问题。在初始可行解生成完毕后，需要使用改进的ALNS算法对初始解进行进一步优化。本节详细介绍改进ALNS算法的各个组成部分。

### 4.4.1 解的编码与评价

**解的编码：** 解 $S$ 由卡车路径 $\pi^U$ 和无人机任务集 $\pi^D$ 两部分组成。卡车路径采用节点序列编码，每条路径以仓库节点"0"起始和终止。每个无人机任务 $k$ 的编码为 $(launchArc, i, receiveArc, j; v^-, v^+, \lambda^-, \lambda^+)$，其中 $launchArc$ 和 $receiveArc$ 分别表示起飞弧和回收弧，$i$ 和 $j$ 为弧的端点节点，$v^-$ 和 $v^+$ 分别表示去程和返程的速度档位（$v^-, v^+ \in V$），$\lambda^- \in [0,1]$ 和 $\lambda^+ \in [0,1]$ 分别表示起飞点和回收点在对应弧上的位置比例参数（0表示在弧的起点，1表示在弧的终点）。

这种编码方式的核心优势在于：通过连续参数 $\lambda$ 表示弧中同步点位置，避免了离散化导致的变量爆炸问题。Li等人(2022)在TDRP-SA问题中采用了移动发射/回收点（moving-LRL）的概念来处理弧中同步，通过三角几何关系确定弧上同步点位置，但其模型依赖于分段线性函数的近似。Cui等人(2024)在研究动态协同配送问题时指出，现有的弧中同步方法主要侧重于识别有利位置或同步会合点，但在动态路径过程中确定最优弧中起降点是更大的挑战。本文通过显式的连续参数 $\lambda$ 编码，结合速度档位编码 $v^-, v^+$，支持去程和返程的差异化速度决策，能够更精确地表示弧上任意位置的同步点。

**解质量评价：** 代价函数 $Cost(S)$ 在目标函数基础上加入软惩罚项，以允许暂时不可行解参与搜索，提高算法的鲁棒性：

$$Cost(S) = f(S) + \alpha_1 \cdot P_{tw}(S) + \alpha_2 \cdot P_{energy}(S) + \alpha_3 \cdot P_{load}(S)$$

其中 $f(S)$ 为原目标函数值（包含运输成本、能耗成本和同步等待惩罚成本），$P_{tw}(S)$ 为时间窗违反惩罚，$P_{energy}(S)$ 为能耗冗余违反惩罚，$P_{load}(S)$ 为载重违反惩罚，$\alpha_1, \alpha_2, \alpha_3$ 为对应的惩罚系数。随着迭代推进，惩罚系数逐步增大，引导搜索趋向可行域。Li等人(2022)在处理不可行解时同样采用了大惩罚值策略，将违反约束的方案的成本设定为一个足够大的整数，本文在此基础上采用软惩罚的渐进增长策略，以在搜索初期保留更多的解空间多样性。

### 4.4.2 算子设计

针对enRTSP-DVS问题的特性，本文设计了多组破坏算子和修复算子。与传统ALNS仅对客户节点进行操作不同，本文的算子同时涉及客户分配、无人机任务调整、弧中同步点重定位和速度决策优化。Li等人(2022)在TDRP-SA问题中将解中的路线分为三类（无人机路线、卡车路线和组合路线），并要求修复算子在插入客户时同时检查车辆容量、路径时长、时间窗和弧中同步约束，必要时调用同步点定位算法重新定位moving-LRL。本文在此基础上进一步引入了速度维度的操作。

#### （1）破坏算子

**D1：随机移除算子。** 从当前解中随机选取若干客户节点（或无人机任务），将其从原路径（或任务集）中移除，放入待重新插入的客户池中。移除的客户数量与当前解的规模成正比，以保证算法对不同规模问题的适应性。这种随机性有助于算法探索更广泛的解空间，是ALNS算法中最基础的破坏策略。

**D2：时间冲突移除算子。** 遍历当前解中所有客户节点和无人机任务，识别存在时间窗冲突的元素，即卡车到达时间 $\tau_i^U$ 或无人机到达时间 $\tau_i^D$ 超出客户时间窗 $[e_c, l_c]$ 的任务。优先移除时间冲突最严重的客户，将其加入待处理池。该算子针对性地修复时间可行性问题。

**D3：高能耗移除算子。** 计算每个无人机任务的总能耗 $E_{ijk}$，移除总能耗超过安全冗余阈值 $(1-\theta) \cdot e^D$ 的无人机任务段。该算子的设计依据来自无人机能耗特性的理论分析。Dorling等人(2017)通过理论推导和实验验证表明，多旋翼无人机的能耗与总重量（含电池和有效载荷）近似呈线性关系。该文对3D Robotics Hexa-B六旋翼无人机的飞行测试显示，在悬停、水平飞行和高度变化三种状态下，平均功耗水平近似相等，这意味着可以用悬停功耗作为飞行功耗的合理估计。进一步的线性回归实验得到功耗系数 $\alpha = 46.7$ W/kg（每千克负载的功率增量）和 $\beta = 26.9$ W（无载荷时的基础功率），平均误差仅3.1%。这一线性特性意味着高载重任务的能耗代价远高于低载重任务。因此，高能耗移除算子通过释放这些能耗紧张的任务，为后续修复阶段提供更多的速度和路径调整空间。

**D4：同步瓶颈移除算子。** 识别当前解中卡车-无人机同步等待时间最长的任务。在弧中同步场景下，由于无人机与卡车移动轨迹的时空复杂性，部分任务可能存在严重的同步等待（卡车等无人机或无人机等卡车）。该算子的设计借鉴了Li等人(2022)的Shaw移除算子思想——根据元素之间的相似度进行关联移除。在本文中，相似度的衡量标准从空间距离扩展为时间同步偏差：同步等待时间越长的任务，说明当前的同步点位置、速度组合或弧段选择越不合理。该算子优先移除同步瓶颈任务，为重新优化同步点位置和速度决策创造条件。

**D5：随机速度清除算子。** 随机选取3-5个无人机任务，清除其速度决策和同步点决策（但不移除客户分配），使这些任务的速度档位和弧中同步位置参数进入待重新求解状态。该算子专门针对速度-能耗耦合优化，通过局部重置速度决策来探索更优的变速方案。这一操作的独特性在于：它不改变客户的服务模式（仍由无人机服务），仅释放速度和同步点维度的决策自由度，使后续修复能够在保持任务结构不变的情况下重新优化变速策略。

#### （2）修复算子

**R1：贪心插入算子。** 对待处理池中的客户，逐一尝试插入当前解的所有可行位置（包括卡车路径和无人机任务），选择使总成本增量最小的位置进行插入。对于插入为无人机任务的客户，同时确定最优的起飞弧、回收弧、同步点位置和速度档位。Li等人(2022)在TDRP-SA问题的修复操作中定义了七种可行的插入位置：（i）构造新的无人机直接服务路线；（ii）插入现有无人机路线；（iii）构造新卡车路线；（iv）插入现有卡车路线；（v）构造新子巡程并调用同步点定位算法；（vi）插入现有子巡程；（vii）构造新组合路线。本文的贪心插入算子借鉴此多位置枚举策略，但进一步引入速度档位的枚举，形成"位置×速度"的二维搜索空间。

**R2：能耗最优插入算子。** 在插入客户时，以最小化能耗增量 $\Delta E$ 为准则选择插入位置和速度档位 $v \in V$。该算子在修复过程中优先考虑能耗效率，适用于能耗约束紧张的场景。Zeng等人(2019)推导了旋翼无人机推进功耗的闭式表达，将功耗分解为叶片型面功率（blade profile power）、诱导功率（induced power）和寄生阻力功率（parasite power）三个分量：

$$P(V) = P_0\left(1 + \frac{3V^2}{U_{tip}^2}\right) + P_i\left(\sqrt{1 + \frac{V^4}{4v_0^4}} - \frac{V^2}{2v_0^2}\right)^{1/2} + \frac{1}{2}d_0\rho s A V^3$$

其中 $P_0$ 和 $P_i$ 分别为悬停时的叶片型面功率和诱导功率，$U_{tip}$ 为桨叶尖端速度，$v_0$ 为悬停时的平均旋翼诱导速度，$d_0$ 和 $s$ 分别为机身阻力比和旋翼密实度，$\rho$ 和 $A$ 分别为空气密度和旋翼盘面积。基于此模型，Zeng等人定义了单位距离能耗函数 $E_0(V) = P(V)/V$，从而引出两个关键速度：最大续航速度 $V_{me} = \arg\min_{V \geq 0} P(V)$（使功耗最小）和最大航程速度 $V_{mr} = \arg\min_{V \geq 0} E_0(V)$（使单位距离能耗最小）。在实际中通常有 $V_{me} \leq V_{mr} \leq V_{max}$。本文的能耗最优插入算子利用这一理论，对每个候选插入位置枚举所有可行的速度组合 $(v^-, v^+)$，优先选择使每段飞行距离的能耗接近 $E_0(V_{mr})$ 的速度组合。

**R3：时间协同插入算子。** 以最小化卡车-无人机同步等待时间差 $|\tau_j^D - \tau_j^U|$ 为准则进行插入。该算子优先将客户插入能够实现最佳时空同步的位置，减少不必要的等待时间。在弧中同步场景下，同步等待时间直接影响整体配送效率。Cui等人(2024)的数值实验表明，采用弧中同步策略相比传统节点同步策略，可平均节省0.9 h/(无人机·天)的等待时间，总利润提升8.43%，这充分说明了精确时间协同的重要性。在本文中，对于弧中同步操作，同步等待时间的计算需要结合连续参数 $\lambda$ 和卡车在弧上的行驶进度：卡车到达同步点的时刻取决于 $\lambda$ 值和卡车在该弧段上的速度，而无人机到达同步点的时刻取决于飞行距离和所选速度档位。

**R4：动态变速修复算子。** 针对D5算子清除速度决策后的任务，对路径段重新分配速度档位。修复策略遵循"重载低速节能、轻载高速提效"的原则。这一策略的理论依据来自Liu等人(2017)提出的多旋翼无人机功耗模型。Liu等人基于直升机理论推导了多旋翼无人机的理论功耗模型，将总功耗分解为诱导功率（$P_i$，产生推力所需）、型面功率（$P_p$，克服桨叶旋转阻力）和寄生阻力功率（$P_{par}$，克服机体前进阻力）三个分量：

$$P_{total} = P_i(T, V_{vert}) + P_p(T, V_{air}) + P_{par}(V_{air})$$

其中推力 $T = \sqrt{(mg-L)^2 + D^2}$ 是总重量 $m$（含载荷）、升力 $L$ 和阻力 $D$ 的函数。该模型在IRIS+四旋翼无人机上的实验验证表明：（1）在低速飞行阶段（$V_{air} < 10$ m/s），功耗基本保持恒定，主要由诱导功率和型面功率主导；（2）在高速飞行阶段，寄生阻力功率 $P_{par} = c_4 V_{air}^3$ 迅速增长，成为功耗的主要分量；（3）功耗是载荷和速度的超线性函数。这些实验结论支持了"重载低速"的策略合理性——当无人机携带较重包裹时，推力 $T$ 增大导致诱导功率和型面功率大幅上升，此时选择较低速度可以避免寄生阻力功率的叠加效应；而空载返程时载重显著降低，即使提高速度，总功耗的增幅也相对有限。

具体而言，动态变速修复算子按照如下规则执行：对去程（载货飞行），根据包裹重量 $Q_k$ 与无人机最大载重 $q^D$ 的比值选择速度档——比值越高则选择越低的速度；对返程（空载飞行），在不违反同步时间约束的前提下选择较高速度以缩短飞行时间。

**R5：同步点微调修复算子。** 在客户重新插入为无人机任务后，对同步点位置参数 $\lambda^-$ 和 $\lambda^+$ 进行局部微调。Li等人(2022)在TDRP-SA问题中通过三角几何关系确定移动同步点（moving-LRL）的位置，其核心公式为：已知卡车在弧 $(A, B)$ 上的行驶时间和无人机到达客户 $I$ 的时间，通过求解三角形余弦方程确定弧上的发射距离 $d_{EA}$：

$$d_{EI} = h_1 d_{EA} + h_2$$

其中 $h_1 = -v^\mu / v^f$ 为无人机速度与卡车速度之比的负值，$h_2 = (t_I - t_A) \cdot v^\mu$ 为时间差与无人机速度的乘积。本文借鉴这一几何计算思路，但将离散的三角求解扩展为连续参数 $\lambda$ 的微调操作：在给定弧段上的小范围内（如 $\lambda \pm 0.1$）搜索最优的同步点位置，使卡车到达时刻与无人机到达时刻尽量对齐，减少同步等待。

### 4.4.3 算子评分策略和算子权重更新

每次ALNS算法迭代中，算子评分统计表根据所选破坏和修复算子的表现进行更新。每迭代 $\varphi$ 次后，算法进入权重调整阶段，根据权重更新公式调整破坏和修复算子权重，同时对各算子的评分进行重新设定。

本文将所有破坏算子和修复算子的初始权重均设为相等值，使所有算子在算法开始时具有同等的被选概率。当执行破坏和修复操作后，根据新解的质量对算子进行评分：

- 若新解优于当前解，则 $\Omega[d] \leftarrow \Omega[d] + \sigma_1$，$\Omega[r] \leftarrow \Omega[r] + \sigma_1$
- 若新解优于全局最优解，则 $\Omega[d] \leftarrow \Omega[d] + \sigma_2$，$\Omega[r] \leftarrow \Omega[r] + \sigma_2$（$\sigma_2 > \sigma_1$）
- 若新解未被接受，则 $\Omega[d] \leftarrow \Omega[d] - \sigma_3$，$\Omega[r] \leftarrow \Omega[r] - \sigma_3$

其中 $\sigma_1, \sigma_2, \sigma_3$ 分别为奖励步长和惩罚步长。与传统ALNS中增加的评分为恒定值不同，本文为 $\sigma_1, \sigma_2, \sigma_3$ 设定了一个特定的范围，每次评分时在该范围内产生随机数作为得分。这种方法使得算法的计算过程具有一定程度的不确定性和多样化，从而增加了找到全局最优解的可能性。Li等人(2022)在TDRP-SA问题中采用了PSO驱动的自适应概率机制，通过粒子位置编码算子对并利用粒子速度更新公式进行概率调整，虽然理论上更为精细，但增加了额外的参数（粒子数、惯性权重 $\omega$、加速系数 $\varepsilon_1, \varepsilon_2$ 等）和计算开销。本文选择随机化评分方案作为一种轻量级的替代方案，在保持自适应性的同时避免引入过多超参数。

算子选择采用轮盘赌法。设第 $i$ 个算子的权重为 $\omega_i$，则该算子被选中的概率为：

$$P_i = \frac{\omega_i}{\sum_{j=1}^{n} \omega_j}$$

### 4.4.4 速度选择操作

本文设计的改进ALNS算法不仅对客户节点和无人机任务进行破坏和修复操作，同时将速度选择作为独立的优化操作嵌入搜索过程中。这是区别于传统ALNS算法的关键改进之一。

**（1）速度选择操作的理论基础**

在enRTSP-DVS问题中，无人机的飞行速度直接影响飞行时间、能耗水平和同步等待时间三个关键指标。速度对能耗的影响并非简单的单调关系，而是涉及多种物理机制的非线性耦合。

**多旋翼无人机功耗模型。** Liu等人(2017)基于直升机空气动力学理论推导了多旋翼无人机的理论功耗模型，并在3D Robotics IRIS+四旋翼无人机上进行了实验验证。该模型将总功耗分解为三个物理分量：

- **诱导功率（Induced Power）$P_i$：** 由旋翼盘面下方气流产生推力所消耗，是推力和垂直速度的函数。在悬停状态下 $P_{i,hover}(T) = c_1 T^{3/2}$，其中 $c_1 = k_1/k_2$（$k_1 \in [0,1]$ 为均匀气流偏差修正因子，$k_2 = \sqrt{2\rho A}$）。随着前飞速度增大，诱导功率逐渐降低，因为前进运动有助于气流通过旋翼盘面。

- **型面功率（Profile Power）$P_p$：** 由旋翼桨叶旋转克服自身阻力所消耗。在悬停状态下 $P_{p,hover} = c_2 T^{3/2}$。在水平飞行中，型面功率因前进比 $\mu = V_{air}\cos\alpha / (\Omega R)$ 的增大而增长，其增长与速度的平方成正比。

- **寄生阻力功率（Parasite Power）$P_{par}$：** 由机体在空气中运动产生的阻力所消耗，$P_{par} = c_4 V_{air}^3$，其中 $c_4 = C_d \rho A_{quad}/2$（$C_d$ 为机体阻力系数，$A_{quad}$ 为迎风截面积）。该项随速度的三次方迅速增长，是高速飞行时的主要能耗来源。

Liu等人的实验结果（图4-X）显示，功耗总和在低速段（$V_{air} < 10$ m/s）基本保持恒定（约164 W），这是因为诱导功率的减少抵消了寄生阻力的增加；而在高速段（$V_{air} > 15$ m/s），寄生阻力功率的立方增长成为主导因素，功耗急剧上升。水平飞行的总功耗近似为：

$$P_{exp3} \approx (c_1 + c_2) T^{3/2} + c_4 V_{air}^3$$

**闭式推进功耗模型。** Zeng等人(2019)进一步推导了旋翼无人机的闭式推进功耗表达式（式4-1），明确揭示了功耗与速度的非凸、非凹关系：

$$P(V) = \underbrace{P_0\left(1 + \frac{3V^2}{U_{tip}^2}\right)}_{\text{叶片型面功率}} + \underbrace{P_i\left(\sqrt{1 + \frac{V^4}{4v_0^4}} - \frac{V^2}{2v_0^2}\right)^{1/2}}_{\text{诱导功率}} + \underbrace{\frac{1}{2}d_0\rho s A V^3}_{\text{寄生阻力功率}} \quad (4\text{-}1)$$

当 $V \gg v_0$ 时，可近似为凸函数：$P(V) \approx P_0(1 + 3V^2/U_{tip}^2) + P_i v_0/V + \frac{1}{2}d_0\rho s A V^3$。基于此模型，存在两个关键速度点：

- **最大续航速度 $V_{me}$：** 使功耗 $P(V)$ 最小的速度，即 $V_{me} = \arg\min_{V \geq 0} P(V)$。以此速度飞行可最大化飞行时间。
- **最大航程速度 $V_{mr}$：** 使单位距离能耗 $E_0(V) = P(V)/V$ 最小的速度，即 $V_{mr} = \arg\min_{V \geq 0} E_0(V)$。以此速度飞行可最大化飞行距离。

在实际配送场景中，通常有 $V_{me} \leq V_{mr} \leq V_{max}$。这一结论对速度选择策略具有重要指导意义：在续航紧张时应接近 $V_{me}$ 飞行以延长飞行时间，在需要覆盖远距离时应接近 $V_{mr}$ 飞行以最大化航程。

**线性能耗近似。** Dorling等人(2017)通过对多旋翼无人机的实验测量，提出了恒定速度下功耗的线性近似模型 $p(m) = \alpha m + \beta$，其中 $m$ 为电池和有效载荷的总重量。该近似在0-3 kg载荷范围内的平均误差为3.1%，最大误差为6.3 W。进一步的实验验证表明，无人机在悬停、水平飞行和高度变化过程中的平均功耗近似相等，这简化了飞行能耗的估算。Dorling等人通过模拟退火启发式求解无人机配送VRP时发现，最小配送成本与配送时限呈反比指数关系，最小配送时间与预算呈反比指数关系，这些结论凸显了优化能耗（进而优化电池重量和飞行速度）在无人机配送中的重要性。

**简化能耗模型。** 综合上述理论研究，本文采用三项式参数化能耗模型用于算法计算：

$$E_{ijk} = \alpha_{v} \cdot r + \beta_{v} \cdot Q_c \cdot r + \gamma_{v} \cdot \frac{r^2}{d}$$

其中 $\alpha_v$ 为速度相关的空载基础能耗系数（对应诱导+型面功率），$\beta_v$ 为载荷能耗系数（对应载荷引起的推力增量），$\gamma_v$ 为气动阻力能耗系数（对应寄生阻力功率），$r$ 为飞行距离，$Q_c$ 为客户需求（包裹重量），$d$ 为直线距离。该模型的参数通过对式(4-1)中的物理参数进行归一化和回归拟合得到，保留了功耗随速度的非线性特征，同时在算法迭代中具有较高的计算效率。

**（2）速度选择策略**

速度选择操作在每次修复阶段完成后执行，作为解优化的一个独立步骤。对于解中的每个无人机任务 $(i \rightarrow k \rightarrow j)$，速度选择操作需要确定去程速度 $v^-$ 和返程速度 $v^+$（$v^-, v^+ \in V = \{v_1, v_2, ..., v_n\}$），使得在满足能耗约束和同步约束的前提下，最小化该任务的综合成本。

具体策略遵循以下规则：

**规则1：基于等待状态的速度调整。** 在修复后检查每个无人机任务的同步状态：

- 若卡车等待无人机（$\tau_{ijk}^R > \psi_{ikj}^+$，即无人机到达回收点晚于卡车），则优先提高返程（空载）速度以缩短飞行时间。这一操作的合理性在于：返程为空载飞行，根据Liu等人(2017)的实验结论，空载时推力 $T$ 较小，即使提高速度，诱导功率和型面功率的增幅有限；同时提速可以有效减少卡车等待时间。若提高返程速度仍不足以消除同步等待，再提高去程（载货）速度。
- 若无人机等待卡车（$\psi_{ikj}^+ > \tau_{ijk}^R$，即卡车到达回收点晚于无人机），则在不迟到回收的条件下降低返程速度以节省能耗。根据Zeng等人(2019)的分析，降低速度使功耗向 $V_{me}$ 方向移动，在不影响同步可行性的前提下可显著减少能耗。

**规则2：能耗-时间联合优化。** 对每个任务枚举所有可行的速度组合 $(v^-, v^+)$，计算对应的总能耗：

$$E_{ijk} = \alpha_{v^-} \cdot r_{ijk}^- + \beta_{v^-} \cdot Q_k \cdot r_{ijk}^- + \gamma_{v^-} \cdot (r_{ijk}^-)^2 / d_{ik} + \alpha_{v^+} \cdot r_{ijk}^+ + \gamma_{v^+} \cdot (r_{ijk}^+)^2 / d_{kj}$$

其中 $r_{ijk}^-$ 和 $r_{ijk}^+$ 分别为去程和返程飞行距离。选择满足安全冗余约束 $E_{ijk} \leq (1-\theta) \cdot e^D$ 且使综合成本最小的速度组合。注意返程为空载飞行，因此能耗表达式中不含 $\beta_{v^+} \cdot Q_k$ 项。

**规则3：不可行任务的级联修复。** 若经速度调整后任务仍不可行（能耗超限或时间窗违反），则按以下优先级执行级联修复：变换回收弧 → 变换起飞弧 → 变更为卡车服务（添加惩罚保留）。这种级联策略确保了算法的鲁棒性，即使在极端约束条件下也能找到可行的处理方案。

**（3）速度选择操作的伪代码**

```
算法4-4 速度选择操作
输入：当前解S中的无人机任务集合 π^D
for each task (i→k→j, v⁻, v⁺, λ⁻, λ⁺) in π^D:
    计算卡车到达回收点时刻 ψ⁺ 和无人机到达回收点时刻 τ_R
    if τ_R > ψ⁺ (卡车等待无人机):
        # 规则1a：优先提高空载返程速度
        for v⁺_new in V (从高到低):
            计算新返程时间和能耗（空载）
            if 满足能耗约束 E ≤ (1-θ)·e^D and 满足同步约束:
                v⁺ ← v⁺_new; break
        if 仍不满足:
            # 规则1b：再提高载货去程速度
            for v⁻_new in V (从高到低):
                计算新去程时间和能耗（含载荷Q_k）
                if 满足所有约束:
                    v⁻ ← v⁻_new; break
    elif ψ⁺ > τ_R (无人机等待卡车):
        # 规则1c：降低返程速度节能
        for v⁺_new in V (从低到高):
            if 无人机到达时刻仍 ≤ 卡车到达时刻:
                v⁺ ← v⁺_new  # 向V_me方向调整
            else:
                break
    # 规则2：枚举最优速度组合
    best_cost ← ∞
    for (v⁻_c, v⁺_c) in V × V:
        计算 E_ijk = α_{v⁻_c}·r⁻ + β_{v⁻_c}·Q_k·r⁻ + γ_{v⁻_c}·(r⁻)²/d + α_{v⁺_c}·r⁺ + γ_{v⁺_c}·(r⁺)²/d
        if E_ijk ≤ (1-θ)·e^D and 时间窗可行:
            计算综合成本 cost_c
            if cost_c < best_cost:
                best_cost ← cost_c; v⁻ ← v⁻_c; v⁺ ← v⁺_c
    更新任务编码 (i→k→j, v⁻, v⁺, λ⁻, λ⁺)
    if 任务仍不可行:
        # 规则3：级联修复
        执行级联修复（变换弧/转卡车服务）
输出：速度优化后的解S'
```

### 4.4.5 局部搜索策略

在破坏-修复-速度选择操作之后，本文引入局部搜索策略进一步增强解的质量。局部搜索包含以下操作：

**（1）2-opt路径优化。** 对卡车路径执行经典的2-opt交换操作，即选取路径中两个非相邻的边，将其断开并重新连接，以减少路径总长度。在执行2-opt操作时，需要同步检查与该路径段关联的无人机任务的同步可行性——若路径变更导致卡车到达某弧的时间发生变化，则需要重新计算该弧上所有同步点的时间关系。

**（2）速度微调。** 对无人机任务在相邻速度档位之间进行切换尝试（如 $v=15 \rightarrow v=12$ 或 $v=12 \rightarrow v=15$ m/s），评估速度微调后的成本变化，接受改善解。根据Zeng等人(2019)的功耗曲线分析，在 $V_{me}$ 附近的速度区间内，功耗变化相对平缓，因此小幅度的速度微调可能在不显著增加能耗的情况下改善同步等待时间。

**（3）无人机任务迁移。** 将某客户从卡车服务模式转为无人机服务模式（或反向迁移），需同时校验无人机载重约束 $q^D$ 和能耗上限 $(1-\theta) \cdot e^D$。该操作能够在卡车和无人机之间动态调整任务分配，充分利用无人机的灵活性。Dorling等人(2017)的研究通过数值实验证实了无人机重复使用（drone reuse）的重要性，即允许无人机多次执行配送任务可显著降低总配送成本，这进一步支持了任务迁移操作在优化中的价值。

**（4）同步点位置优化。** 对无人机任务的弧中同步点参数 $\lambda^-$ 和 $\lambda^+$ 进行连续微调。在每次修复后，先重建卡车时间轴，再在给定弧段的小范围内调整连续参数，更新同步位置和同步时刻。Lan等人(2024)的研究表明，利用弧上的中间点（Intermediate Points, IPs）作为无人机起降位置相比仅使用节点同步，可平均节省2.189%的配送时间，这证实了弧中同步点位置优化的有效性。本文的连续几何计算由嵌入子程序完成，利用Li等人(2022)提出的三角几何方法作为计算基础，但将离散求解扩展为连续参数搜索，避免了离散化导致的精度损失。

### 4.4.6 停止与重启策略

**（1）温度冷却。** 每次迭代后执行模拟退火的温度冷却：$T \leftarrow T \cdot \alpha$，其中冷却系数 $\alpha \in [0.95, 0.99]$。

**（2）重启机制。** 当连续无改进迭代次数 $NoImprove$ 超过预设阈值 $RestartIter$ 时，触发重启操作。重启策略对当前全局最优解进行扰动：随机调整5个客户的卡车/无人机服务模式，随机改变3条路径的无人机速度档位，以此为搜索注入多样性。

**（3）终止条件。** 算法在以下两个条件之一满足时终止：达到预设的最大迭代次数 $MaxIter$；或连续多次重启后解的质量仍无改善。

### 4.4.7 改进ALNS算法总体框架

综合以上各部分，改进ALNS算法的总体框架如下：

```
算法4-5 改进的自适应大邻域搜索（IALNS）
1: 初始化
2: S_curr ← 两阶段初始解生成（卡车路径+无人机任务，含速度选择）
3: S_best ← S_curr
4: Ω ← 初始化破坏/修复算子权重表（均匀分布）
5: iter ← 0; NoImprove ← 0
6: while iter < MaxIter do
7:     # 动态选择算子（轮盘赌）
8:     破坏算子 d ← select_destroy_operator(Ω)
9:     修复算子 r ← select_repair_operator(Ω)
10:    # 破坏阶段
11:    S_temp ← d(S_curr)
12:    # 修复阶段
13:    S_candidate ← r(S_temp)
14:    # 速度选择操作（4.4.4节）
15:    S_candidate ← SpeedSelection(S_candidate)
16:    # 局部搜索（4.4.5节）
17:    S_candidate ← LocalSearch(S_candidate)
18:    # 接受准则（模拟退火）
19:    if Cost(S_candidate) < Cost(S_curr) or 
20:       exp(-ΔCost/T) > rand(0,1) then
21:        S_curr ← S_candidate
22:        if Cost(S_curr) < Cost(S_best) then
23:            S_best ← S_curr; NoImprove ← 0
24:        else:
25:            NoImprove += 1
26:    else:
27:        NoImprove += 1
28:    # 自适应权重更新（4.4.3节）
29:    更新算子评分和权重 Ω
30:    # 温度冷却
31:    T ← T * α
32:    # 重启判定
33:    if NoImprove > RestartIter:
34:        S_curr ← Perturb(S_best)
35:        NoImprove ← 0
36:    iter += 1
37: end while
38: return S_best
```

与经典ALNS相比，改进算法的核心差异在于：（1）在破坏-修复循环中嵌入了速度选择操作（第14-15行），将变速决策从主搜索中分离，作为嵌入子程序处理，降低了主搜索的复杂度；（2）破坏算子和修复算子针对弧中同步和能耗约束进行了定制化设计，其中高能耗移除算子(D3)基于Dorling等人(2017)的线性能耗特性、同步瓶颈移除算子(D4)借鉴Li等人(2022)的Shaw移除思想、动态变速修复算子(R4)以Liu等人(2017)的功耗分解模型为理论依据；（3）解的编码引入了连续参数 $\lambda$ 表示弧中同步点，配合同步点微调操作实现了精细化的时空同步优化。

## 4.5 本章小结

本章针对enRTSP-DVS问题设计了改进的自适应大邻域搜索算法（IALNS）。首先介绍了ALNS算法的基本原理和标准步骤，阐明了其"破坏-修复"迭代框架和自适应算子选择机制。然后提出了两阶段初始解生成方法，分别构造卡车路径和插入无人机任务。

在改进ALNS算法设计中，本章详细描述了解的编码方式和评价函数，设计了5种破坏算子（随机移除、时间冲突移除、高能耗移除、同步瓶颈移除、随机速度清除）和5种修复算子（贪心插入、能耗最优插入、时间协同插入、动态变速修复、同步点微调修复），提出了带随机性的算子评分策略和权重更新机制。在算子设计中，本文充分借鉴了相关文献的理论成果：D3算子的设计基于Dorling等人(2017)揭示的能耗-载重线性关系，R2算子的能耗评估参考了Zeng等人(2019)推导的旋翼无人机闭式功耗模型及其最大续航/最大航程速度概念，R4算子的变速策略以Liu等人(2017)验证的多旋翼功耗三分量模型为理论基础，R5算子和同步点优化借鉴了Li等人(2022)在TDRP-SA问题中提出的三角几何同步点定位方法。

特别地，本章引入了速度选择操作替代传统的路径分割点操作，将无人机变速决策嵌入搜索过程，通过"重载低速节能、轻载高速提效"的策略实现能耗-时间-同步的联合优化。Cui等人(2024)的研究表明弧中同步策略可平均节省0.9 h/(无人机·天)的等待时间，Lan等人(2024)证实弧上中间点同步可节省2.189%配送时间，这些实证结果支持了本文算法中弧中连续同步与变速优化设计的合理性。

最后介绍了局部搜索策略和停止重启机制，给出了改进ALNS算法的完整框架。这些改进措施使得算法能够更有效地处理弧中同步和速度可变带来的复杂约束，为后续的算例实验和性能验证奠定了基础。